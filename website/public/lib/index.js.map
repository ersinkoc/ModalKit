{"version":3,"sources":["../src/core/config.ts","../src/utils/events.ts","../src/core/state.ts","../src/core/stack.ts","../src/utils/focus.ts","../src/features/focus-trap.ts","../src/utils/dom.ts","../src/features/scroll-lock.ts","../src/features/animation.ts","../src/features/keyboard.ts","../src/features/portal.ts","../src/utils/id.ts","../src/core/modal.ts","../src/dialogs/base.ts","../src/dialogs/confirm.ts","../src/dialogs/alert.ts","../src/dialogs/prompt.ts"],"names":["DEFAULT_CONFIG","mergeConfig","config","createEventEmitter","listeners","on","event","handler","off","handlers","emit","args","error","clear","createSubscriptionManager","subscribers","subscribe","callback","notify","value","createInitialState","defaultOpen","createStateManager","initialState","state","getState","setState","partial","prevState","hasStateChanged","prev","next","shouldBeMounted","open","animationState","BASE_Z_INDEX","Z_INDEX_INCREMENT","calculateZIndex","stackOrder","createModalStack","stack","events","updateStackState","modal","index","order","isTopMost","push","remove","count","isEmpty","getAll","getTopMost","getByOrder","closeAll","closeTopMost","topMost","modalStack","stackInternal","FOCUSABLE_SELECTOR","isVisible","element","style","isFocusable","getFocusableElements","container","elements","getFirstFocusable","getLastFocusable","focusables","getActiveElement","doc","activeElement","focusElement","options","savedFocus","saveFocus","restoreFocus","preventScroll","scrollX","scrollY","createFocusTrap","initialFocus","fallbackFocus","returnFocus","escapeDeactivates","clickOutsideDeactivates","allowOutsideClick","onActivate","onDeactivate","active","paused","resolveElement","ref","handleKeyDown","firstFocusable","lastFocusable","handleEscapeKey","deactivate","handleClick","target","handleFocusIn","activate","initialElement","fallbackElement","elementToFocus","returnElement","pause","unpause","isActive","isPaused","getElement","createPortalContainer","id","removeElement","getScrollbarWidth","outer","inner","scrollbarWidth","contains","parent","child","lockCount","originalStyles","isIOS","getScrollPosition","scrollPosition","lock","hasScrollbar","currentPadding","unlock","isLocked","scrollLock","createAnimationController","duration","onStateChange","onAnimationStart","onAnimationEnd","timerId","clearTimer","newState","startEnter","startExit","skipTo","targetState","isAnimating","destroy","createNoopAnimationController","isEscapeKey","createKeyboardHandler","closeOnEscape","onEscapeKeyDown","onClose","DEFAULT_PORTAL_ID","getPortalContainer","counter","generateId","prefix","createModalIds","baseId","createModal","userConfig","ids","initialOpen","stateManager","animationController","focusTrap","contentElement","overlayElement","containerElement","close","setupFocusTrap","teardownFocusTrap","activateFocusTrap","handleOpen","handleClose","finalFocus","handleOverlayClick","e","isOpen","isMounted","toggle","getStackOrder","getAnimationState","focusFirst","first","focusLast","last","getPortalTarget","getPortalProps","getOverlayProps","zIndex","el","getContainerProps","scrollBehavior","getContentProps","props","wasNull","getTitleProps","customId","getDescriptionProps","getCloseButtonProps","getTriggerProps","getConfig","setConfig","newConfig","isTop","createDialogElements","portal","portalProps","overlay","overlayProps","containerProps","content","contentProps","createDialogModal","customConfig","styleButton","button","variant","createTitleElement","title","titleProps","titleEl","createMessageElement","message","descProps","messageEl","createButtonContainer","DEFAULT_OPTIONS","confirm","messageOrOptions","resolve","confirmText","cancelText","closeOnOverlayClick","buttons","resolved","cleanup","buttonContainer","buttonsToRender","autoFocusButton","btnConfig","getButtonVariant","alertVariant","alert","confirmButton","prompt","placeholder","defaultValue","type","validate","required","minLength","maxLength","inputContainer","input","errorEl","validateInput","showError","clearError","handleSubmit","validationResult","cancelButton"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Default configuration and config utilities for ModalKit\n */\n\nimport type { ModalConfig } from '../types'\n\n/**\n * Default modal configuration\n */\nexport const DEFAULT_CONFIG: Required<\n  Omit<\n    ModalConfig,\n    | 'open'\n    | 'initialFocusRef'\n    | 'finalFocusRef'\n    | 'portalTarget'\n    | 'id'\n    | 'ariaLabel'\n    | 'ariaLabelledBy'\n    | 'ariaDescribedBy'\n    | 'onOpen'\n    | 'onClose'\n    | 'onOpenChange'\n    | 'onAnimationStart'\n    | 'onAnimationEnd'\n    | 'onEscapeKeyDown'\n    | 'onOverlayClick'\n  >\n> = {\n  defaultOpen: false,\n  closeOnOverlayClick: true,\n  closeOnEscape: true,\n  preventScroll: true,\n  scrollBehavior: 'inside',\n  trapFocus: true,\n  autoFocus: true,\n  restoreFocus: true,\n  stackable: true,\n  closeOnStackedOpen: false,\n  animated: false,\n  animationDuration: 200,\n  disablePortal: false,\n  role: 'dialog',\n}\n\n/**\n * Merge user config with defaults\n */\nexport function mergeConfig(config?: ModalConfig): ModalConfig {\n  if (!config) return { ...DEFAULT_CONFIG }\n\n  return {\n    ...DEFAULT_CONFIG,\n    ...config,\n  }\n}\n\n/**\n * Get a resolved config value\n */\nexport function getConfigValue<K extends keyof ModalConfig>(\n  config: ModalConfig,\n  key: K,\n  defaultValue: NonNullable<ModalConfig[K]>\n): NonNullable<ModalConfig[K]> {\n  const value = config[key]\n  return value !== undefined ? (value as NonNullable<ModalConfig[K]>) : defaultValue\n}\n","/**\n * Event emitter utilities for ModalKit\n */\n\nimport type { EventEmitter } from '../types'\n\n/**\n * Create a typed event emitter\n */\nexport function createEventEmitter<\n  T extends Record<string, unknown[]>\n>(): EventEmitter<T> {\n  const listeners = new Map<keyof T, Set<Function>>()\n\n  function on<K extends keyof T>(\n    event: K,\n    handler: (...args: T[K]) => void\n  ): () => void {\n    if (!listeners.has(event)) {\n      listeners.set(event, new Set())\n    }\n    listeners.get(event)!.add(handler)\n\n    // Return unsubscribe function\n    return () => off(event, handler)\n  }\n\n  function off<K extends keyof T>(\n    event: K,\n    handler: (...args: T[K]) => void\n  ): void {\n    const handlers = listeners.get(event)\n    if (handlers) {\n      handlers.delete(handler)\n      if (handlers.size === 0) {\n        listeners.delete(event)\n      }\n    }\n  }\n\n  function emit<K extends keyof T>(event: K, ...args: T[K]): void {\n    const handlers = listeners.get(event)\n    if (handlers) {\n      handlers.forEach((handler) => {\n        try {\n          handler(...args)\n        } catch (error) {\n          console.error(`Error in event handler for \"${String(event)}\":`, error)\n        }\n      })\n    }\n  }\n\n  function clear(): void {\n    listeners.clear()\n  }\n\n  return { on, off, emit, clear }\n}\n\n/**\n * Create a simple subscription manager for state changes\n */\nexport function createSubscriptionManager<T>(): {\n  subscribe: (callback: (value: T) => void) => () => void\n  notify: (value: T) => void\n  clear: () => void\n} {\n  const subscribers = new Set<(value: T) => void>()\n\n  function subscribe(callback: (value: T) => void): () => void {\n    subscribers.add(callback)\n    return () => {\n      subscribers.delete(callback)\n    }\n  }\n\n  function notify(value: T): void {\n    subscribers.forEach((callback) => {\n      try {\n        callback(value)\n      } catch (error) {\n        console.error('Error in subscriber:', error)\n      }\n    })\n  }\n\n  function clear(): void {\n    subscribers.clear()\n  }\n\n  return { subscribe, notify, clear }\n}\n","/**\n * State management for ModalKit\n */\n\nimport type { ModalState, AnimationState, StateManager } from '../types'\nimport { createSubscriptionManager } from '../utils/events'\n\n/**\n * Create initial modal state\n */\nexport function createInitialState(defaultOpen: boolean = false): ModalState {\n  return {\n    open: defaultOpen,\n    animationState: defaultOpen ? 'entered' : 'idle',\n    stackOrder: 0,\n    isTopMost: false,\n    mounted: defaultOpen,\n  }\n}\n\n/**\n * Create a state manager\n */\nexport function createStateManager(\n  initialState: ModalState\n): StateManager<ModalState> {\n  let state = { ...initialState }\n  const { subscribe, notify } = createSubscriptionManager<ModalState>()\n\n  function getState(): ModalState {\n    return { ...state }\n  }\n\n  function setState(partial: Partial<ModalState>): void {\n    const prevState = state\n    state = { ...state, ...partial }\n\n    // Only notify if state actually changed\n    if (hasStateChanged(prevState, state)) {\n      notify(state)\n    }\n  }\n\n  return {\n    getState,\n    setState,\n    subscribe,\n  }\n}\n\n/**\n * Check if state has changed\n */\nfunction hasStateChanged(prev: ModalState, next: ModalState): boolean {\n  return (\n    prev.open !== next.open ||\n    prev.animationState !== next.animationState ||\n    prev.stackOrder !== next.stackOrder ||\n    prev.isTopMost !== next.isTopMost ||\n    prev.mounted !== next.mounted\n  )\n}\n\n/**\n * Derive mounted state from open and animation state\n */\nexport function shouldBeMounted(\n  open: boolean,\n  animationState: AnimationState\n): boolean {\n  // Mounted when open or during exit animation\n  return open || animationState === 'exiting' || animationState === 'exited'\n}\n\n/**\n * Get the next animation state based on current state and action\n */\nexport function getNextAnimationState(\n  currentState: AnimationState,\n  action: 'open' | 'close',\n  animated: boolean\n): AnimationState {\n  if (!animated) {\n    return action === 'open' ? 'entered' : 'idle'\n  }\n\n  if (action === 'open') {\n    return 'entering'\n  }\n\n  // Close action\n  if (currentState === 'entered' || currentState === 'entering') {\n    return 'exiting'\n  }\n\n  return 'idle'\n}\n","/**\n * Modal stack management for ModalKit\n */\n\nimport type { Modal, ModalStack, ModalInternal, StackEvent } from '../types'\nimport { createEventEmitter } from '../utils/events'\n\n/**\n * Stack event types\n */\ninterface StackEvents extends Record<string, unknown[]> {\n  push: [Modal]\n  pop: [Modal]\n  change: [Modal[]]\n}\n\n/**\n * Base z-index for modals\n */\nexport const BASE_Z_INDEX = 1000\n\n/**\n * Z-index increment per stacked modal\n */\nexport const Z_INDEX_INCREMENT = 10\n\n/**\n * Calculate z-index for a modal at given stack position\n */\nexport function calculateZIndex(stackOrder: number): number {\n  return BASE_Z_INDEX + (stackOrder - 1) * Z_INDEX_INCREMENT\n}\n\n/**\n * Create the modal stack manager\n */\nfunction createModalStack(): ModalStack & {\n  push: (modal: ModalInternal) => void\n  remove: (modal: ModalInternal) => void\n} {\n  const stack: ModalInternal[] = []\n  const events = createEventEmitter<StackEvents>()\n\n  function updateStackState(): void {\n    stack.forEach((modal, index) => {\n      const order = index + 1\n      const isTopMost = index === stack.length - 1\n      modal._setStackOrder(order)\n      modal._setIsTopMost(isTopMost)\n    })\n  }\n\n  function push(modal: ModalInternal): void {\n    // Check if modal is already in stack\n    const existingIndex = stack.indexOf(modal)\n    if (existingIndex !== -1) {\n      return\n    }\n\n    stack.push(modal)\n    updateStackState()\n    events.emit('push', modal)\n    events.emit('change', [...stack])\n  }\n\n  function remove(modal: ModalInternal): void {\n    const index = stack.indexOf(modal)\n    if (index === -1) return\n\n    stack.splice(index, 1)\n    updateStackState()\n    events.emit('pop', modal)\n    events.emit('change', [...stack])\n  }\n\n  function count(): number {\n    return stack.length\n  }\n\n  function isEmpty(): boolean {\n    return stack.length === 0\n  }\n\n  function getAll(): Modal[] {\n    return [...stack]\n  }\n\n  function getTopMost(): Modal | null {\n    return stack[stack.length - 1] ?? null\n  }\n\n  function getByOrder(order: number): Modal | null {\n    return stack[order - 1] ?? null\n  }\n\n  function closeAll(): void {\n    // Close from top to bottom\n    const modalsToClose = [...stack].reverse()\n    modalsToClose.forEach((modal) => modal.close())\n  }\n\n  function closeTopMost(): void {\n    const topMost = getTopMost()\n    if (topMost) {\n      topMost.close()\n    }\n  }\n\n  function on<K extends StackEvent>(\n    event: K,\n    handler: K extends 'change'\n      ? (modals: Modal[]) => void\n      : (modal: Modal) => void\n  ): () => void {\n    return events.on(event, handler as (...args: StackEvents[K]) => void)\n  }\n\n  function off<K extends StackEvent>(\n    event: K,\n    handler: K extends 'change'\n      ? (modals: Modal[]) => void\n      : (modal: Modal) => void\n  ): void {\n    events.off(event, handler as (...args: StackEvents[K]) => void)\n  }\n\n  return {\n    count,\n    isEmpty,\n    getAll,\n    getTopMost,\n    getByOrder,\n    closeAll,\n    closeTopMost,\n    on,\n    off,\n    push,\n    remove,\n  }\n}\n\n/**\n * Global modal stack singleton\n */\nexport const modalStack = createModalStack()\n\n/**\n * Internal stack methods for modal instances\n * @internal\n */\nexport const stackInternal = {\n  push: modalStack.push,\n  remove: modalStack.remove,\n}\n","/**\n * Focus utility functions for ModalKit\n */\n\n/**\n * Selector for focusable elements\n */\nexport const FOCUSABLE_SELECTOR = [\n  'a[href]',\n  'area[href]',\n  'button:not([disabled])',\n  'input:not([disabled])',\n  'select:not([disabled])',\n  'textarea:not([disabled])',\n  '[tabindex]:not([tabindex=\"-1\"])',\n  '[contenteditable=\"true\"]',\n  'audio[controls]',\n  'video[controls]',\n  'details > summary:first-of-type',\n].join(',')\n\n/**\n * Check if an element is visible\n */\nfunction isVisible(element: HTMLElement): boolean {\n  // Check if element is hidden\n  if (\n    element.offsetWidth === 0 &&\n    element.offsetHeight === 0 &&\n    element.getClientRects().length === 0\n  ) {\n    return false\n  }\n\n  // Check computed styles\n  const style = getComputedStyle(element)\n  if (style.visibility === 'hidden' || style.display === 'none') {\n    return false\n  }\n\n  return true\n}\n\n/**\n * Check if an element is focusable\n */\nexport function isFocusable(element: Element): boolean {\n  if (!(element instanceof HTMLElement)) return false\n  if (!element.matches(FOCUSABLE_SELECTOR)) return false\n  if (!isVisible(element)) return false\n\n  return true\n}\n\n/**\n * Get all focusable elements within a container\n */\nexport function getFocusableElements(container: HTMLElement): HTMLElement[] {\n  const elements = container.querySelectorAll<HTMLElement>(FOCUSABLE_SELECTOR)\n  return Array.from(elements).filter(isFocusable)\n}\n\n/**\n * Get the first focusable element in a container\n */\nexport function getFirstFocusable(container: HTMLElement): HTMLElement | null {\n  const focusables = getFocusableElements(container)\n  return focusables[0] ?? null\n}\n\n/**\n * Get the last focusable element in a container\n */\nexport function getLastFocusable(container: HTMLElement): HTMLElement | null {\n  const focusables = getFocusableElements(container)\n  return focusables[focusables.length - 1] ?? null\n}\n\n/**\n * Get the currently focused element\n */\nexport function getActiveElement(doc: Document = document): Element | null {\n  let activeElement = doc.activeElement\n\n  // Handle shadow DOM\n  while (activeElement?.shadowRoot?.activeElement) {\n    activeElement = activeElement.shadowRoot.activeElement\n  }\n\n  return activeElement\n}\n\n/**\n * Focus an element safely\n */\nexport function focusElement(\n  element: HTMLElement | null | undefined,\n  options?: FocusOptions\n): boolean {\n  if (!element) return false\n\n  try {\n    element.focus(options)\n    return getActiveElement() === element\n  } catch {\n    return false\n  }\n}\n\n/**\n * Storage for saved focus state\n */\ninterface FocusState {\n  element: HTMLElement | null\n  scrollX: number\n  scrollY: number\n}\n\nlet savedFocus: FocusState | null = null\n\n/**\n * Save the current focus state\n */\nexport function saveFocus(): void {\n  const activeElement = getActiveElement()\n  savedFocus = {\n    element: activeElement instanceof HTMLElement ? activeElement : null,\n    scrollX: window.scrollX,\n    scrollY: window.scrollY,\n  }\n}\n\n/**\n * Restore previously saved focus state\n */\nexport function restoreFocus(preventScroll: boolean = true): void {\n  if (!savedFocus) return\n\n  const { element, scrollX, scrollY } = savedFocus\n\n  if (element && document.body.contains(element)) {\n    focusElement(element, { preventScroll })\n\n    // Restore scroll position if needed\n    if (preventScroll) {\n      window.scrollTo(scrollX, scrollY)\n    }\n  }\n\n  savedFocus = null\n}\n\n/**\n * Clear saved focus without restoring\n */\nexport function clearSavedFocus(): void {\n  savedFocus = null\n}\n\n/**\n * Check if focus is within a container\n */\nexport function isFocusWithin(container: HTMLElement): boolean {\n  const activeElement = getActiveElement()\n  if (!activeElement) return false\n  return container.contains(activeElement)\n}\n","/**\n * Focus trap implementation for ModalKit\n */\n\nimport type { FocusTrap, FocusTrapConfig } from '../types'\nimport {\n  getFocusableElements,\n  getFirstFocusable,\n  focusElement,\n  getActiveElement,\n  saveFocus,\n  restoreFocus,\n} from '../utils/focus'\n\n/**\n * Create a focus trap instance\n */\nexport function createFocusTrap(config: FocusTrapConfig): FocusTrap {\n  const {\n    container,\n    initialFocus,\n    fallbackFocus,\n    returnFocus,\n    escapeDeactivates = true,\n    clickOutsideDeactivates = false,\n    allowOutsideClick = false,\n    onActivate,\n    onDeactivate,\n  } = config\n\n  let active = false\n  let paused = false\n\n  // Resolve element from ref\n  function resolveElement(\n    ref: HTMLElement | (() => HTMLElement | null) | null | undefined\n  ): HTMLElement | null {\n    if (!ref) return null\n    if (typeof ref === 'function') return ref()\n    return ref\n  }\n\n  // Handle Tab key navigation\n  function handleKeyDown(event: KeyboardEvent): void {\n    if (!active || paused) return\n    if (event.key !== 'Tab') return\n\n    const focusables = getFocusableElements(container)\n    if (focusables.length === 0) return\n\n    const firstFocusable = focusables[0]\n    const lastFocusable = focusables[focusables.length - 1]\n    const activeElement = getActiveElement()\n\n    // Handle Shift+Tab (backwards)\n    if (event.shiftKey) {\n      if (activeElement === firstFocusable || !container.contains(activeElement as Node)) {\n        event.preventDefault()\n        focusElement(lastFocusable)\n      }\n    } else {\n      // Handle Tab (forwards)\n      if (activeElement === lastFocusable || !container.contains(activeElement as Node)) {\n        event.preventDefault()\n        focusElement(firstFocusable)\n      }\n    }\n  }\n\n  // Handle Escape key\n  function handleEscapeKey(event: KeyboardEvent): void {\n    if (!active || paused) return\n    if (event.key !== 'Escape') return\n\n    if (escapeDeactivates) {\n      event.preventDefault()\n      deactivate()\n    }\n  }\n\n  // Handle clicks outside the container\n  function handleClick(event: MouseEvent): void {\n    if (!active || paused) return\n\n    const target = event.target as Node\n    if (!container.contains(target)) {\n      // Check if outside click is allowed\n      const shouldAllowClick =\n        typeof allowOutsideClick === 'function'\n          ? allowOutsideClick(event)\n          : allowOutsideClick\n\n      if (!shouldAllowClick) {\n        event.preventDefault()\n        event.stopPropagation()\n      }\n\n      if (clickOutsideDeactivates) {\n        deactivate()\n      }\n    }\n  }\n\n  // Handle focus leaving the container\n  function handleFocusIn(event: FocusEvent): void {\n    if (!active || paused) return\n\n    const target = event.target as Node\n    if (!container.contains(target)) {\n      // Focus has left the trap, bring it back\n      event.preventDefault()\n      const firstFocusable = getFirstFocusable(container)\n      if (firstFocusable) {\n        focusElement(firstFocusable)\n      } else {\n        // Fallback to container itself\n        container.focus()\n      }\n    }\n  }\n\n  function activate(): void {\n    if (active) return\n\n    // Save current focus for restoration\n    saveFocus()\n\n    active = true\n    paused = false\n\n    // Add event listeners\n    document.addEventListener('keydown', handleKeyDown, true)\n    document.addEventListener('keydown', handleEscapeKey, true)\n    document.addEventListener('click', handleClick, true)\n    document.addEventListener('focusin', handleFocusIn, true)\n\n    // Set initial focus\n    const initialElement = resolveElement(initialFocus)\n    const fallbackElement = resolveElement(fallbackFocus)\n    const firstFocusable = getFirstFocusable(container)\n\n    const elementToFocus =\n      initialElement ??\n      fallbackElement ??\n      firstFocusable ??\n      container\n\n    // Make container focusable as fallback\n    if (!container.hasAttribute('tabindex')) {\n      container.setAttribute('tabindex', '-1')\n    }\n\n    focusElement(elementToFocus as HTMLElement, { preventScroll: true })\n\n    onActivate?.()\n  }\n\n  function deactivate(): void {\n    if (!active) return\n\n    active = false\n    paused = false\n\n    // Remove event listeners\n    document.removeEventListener('keydown', handleKeyDown, true)\n    document.removeEventListener('keydown', handleEscapeKey, true)\n    document.removeEventListener('click', handleClick, true)\n    document.removeEventListener('focusin', handleFocusIn, true)\n\n    // Restore focus\n    const returnElement = resolveElement(returnFocus)\n    if (returnElement) {\n      focusElement(returnElement, { preventScroll: true })\n    } else {\n      restoreFocus(true)\n    }\n\n    onDeactivate?.()\n  }\n\n  function pause(): void {\n    if (!active) return\n    paused = true\n  }\n\n  function unpause(): void {\n    if (!active) return\n    paused = false\n  }\n\n  function isActive(): boolean {\n    return active\n  }\n\n  function isPaused(): boolean {\n    return paused\n  }\n\n  return {\n    activate,\n    deactivate,\n    pause,\n    unpause,\n    isActive,\n    isPaused,\n  }\n}\n","/**\n * DOM utility functions for ModalKit\n */\n\n/**\n * Get an element by selector string or return the element itself\n */\nexport function getElement(\n  target: HTMLElement | string | null | undefined\n): HTMLElement | null {\n  if (!target) return null\n  if (typeof target === 'string') {\n    return document.querySelector(target)\n  }\n  return target\n}\n\n/**\n * Create a portal container element\n */\nexport function createPortalContainer(id?: string): HTMLDivElement {\n  const container = document.createElement('div')\n  if (id) {\n    container.id = id\n  }\n  container.setAttribute('data-modalkit-portal', '')\n  return container\n}\n\n/**\n * Safely remove an element from the DOM\n */\nexport function removeElement(element: HTMLElement | null): void {\n  if (element && element.parentNode) {\n    element.parentNode.removeChild(element)\n  }\n}\n\n/**\n * Check if an element is in the document\n */\nexport function isInDocument(element: HTMLElement | null): boolean {\n  if (!element) return false\n  return document.body.contains(element)\n}\n\n/**\n * Get the document's scrollbar width\n */\nexport function getScrollbarWidth(): number {\n  // Create outer element\n  const outer = document.createElement('div')\n  outer.style.visibility = 'hidden'\n  outer.style.overflow = 'scroll'\n  document.body.appendChild(outer)\n\n  // Create inner element\n  const inner = document.createElement('div')\n  outer.appendChild(inner)\n\n  // Calculate scrollbar width\n  const scrollbarWidth = outer.offsetWidth - inner.offsetWidth\n\n  // Cleanup\n  removeElement(outer)\n\n  return scrollbarWidth\n}\n\n/**\n * Check if the element or its descendants contain another element\n */\nexport function contains(parent: Element | null, child: Element | null): boolean {\n  if (!parent || !child) return false\n  return parent === child || parent.contains(child)\n}\n\n/**\n * Set multiple styles on an element\n */\nexport function setStyles(\n  element: HTMLElement,\n  styles: Partial<CSSStyleDeclaration>\n): void {\n  Object.assign(element.style, styles)\n}\n\n/**\n * Get the owner document of an element\n */\nexport function getOwnerDocument(element: Element | null): Document {\n  return element?.ownerDocument ?? document\n}\n\n/**\n * Check if we're in a browser environment\n */\nexport function isBrowser(): boolean {\n  return typeof window !== 'undefined' && typeof document !== 'undefined'\n}\n","/**\n * Scroll lock implementation for ModalKit\n */\n\nimport type { ScrollLock } from '../types'\nimport { getScrollbarWidth } from '../utils/dom'\n\n// Reference counting for multiple modals\nlet lockCount = 0\n\n// Store original body styles\nlet originalStyles: {\n  overflow: string\n  paddingRight: string\n} | null = null\n\n/**\n * Check if iOS Safari\n * @internal\n */\n/* c8 ignore start */\nfunction isIOS(): boolean {\n  return (\n    typeof navigator !== 'undefined' &&\n    /iPad|iPhone|iPod/.test(navigator.userAgent)\n  )\n}\n\n/**\n * Get current scroll position\n * @internal\n */\nfunction getScrollPosition(): { x: number; y: number } {\n  return {\n    x: window.pageXOffset ?? document.documentElement.scrollLeft,\n    y: window.pageYOffset ?? document.documentElement.scrollTop,\n  }\n}\n/* c8 ignore stop */\n\n// Store scroll position for iOS fix\nlet scrollPosition: { x: number; y: number } | null = null\n\n/**\n * Lock body scroll\n */\nfunction lock(): void {\n  lockCount++\n\n  // Only apply lock on first call\n  if (lockCount > 1) return\n\n  const scrollbarWidth = getScrollbarWidth()\n  const hasScrollbar = window.innerWidth > document.documentElement.clientWidth\n\n  // Save original styles\n  originalStyles = {\n    overflow: document.body.style.overflow,\n    paddingRight: document.body.style.paddingRight,\n  }\n\n  // Apply lock styles\n  document.body.style.overflow = 'hidden'\n\n  // Add padding to prevent layout shift from scrollbar disappearing\n  if (hasScrollbar && scrollbarWidth > 0) {\n    const currentPadding = parseInt(\n      getComputedStyle(document.body).paddingRight,\n      10\n    ) || 0\n    document.body.style.paddingRight = `${currentPadding + scrollbarWidth}px`\n  }\n\n  // iOS Safari fix\n  /* c8 ignore start */\n  if (isIOS()) {\n    scrollPosition = getScrollPosition()\n    document.body.style.position = 'fixed'\n    document.body.style.top = `-${scrollPosition.y}px`\n    document.body.style.left = `-${scrollPosition.x}px`\n    document.body.style.width = '100%'\n  }\n  /* c8 ignore stop */\n}\n\n/**\n * Unlock body scroll\n */\n/* c8 ignore start */\nfunction unlock(): void {\n  if (lockCount === 0) return\n\n  lockCount--\n\n  // Only remove lock on last call\n  if (lockCount > 0) return\n\n  // Restore original styles\n  if (originalStyles) {\n    document.body.style.overflow = originalStyles.overflow\n    document.body.style.paddingRight = originalStyles.paddingRight\n    originalStyles = null\n  }\n\n  // iOS Safari fix - restore scroll position\n  if (isIOS() && scrollPosition) {\n    document.body.style.position = ''\n    document.body.style.top = ''\n    document.body.style.left = ''\n    document.body.style.width = ''\n    window.scrollTo(scrollPosition.x, scrollPosition.y)\n    scrollPosition = null\n  }\n}\n/* c8 ignore stop */\n\n/**\n * Check if scroll is locked\n */\nfunction isLocked(): boolean {\n  return lockCount > 0\n}\n\n/**\n * Force reset scroll lock (useful for testing)\n * @internal\n */\nexport function resetScrollLock(): void {\n  if (originalStyles) {\n    document.body.style.overflow = originalStyles.overflow\n    document.body.style.paddingRight = originalStyles.paddingRight\n    originalStyles = null\n  }\n\n  /* c8 ignore start */\n  if (isIOS()) {\n    document.body.style.position = ''\n    document.body.style.top = ''\n    document.body.style.left = ''\n    document.body.style.width = ''\n  }\n  /* c8 ignore stop */\n\n  lockCount = 0\n  scrollPosition = null\n}\n\n/**\n * Scroll lock singleton\n */\nexport const scrollLock: ScrollLock = {\n  lock,\n  unlock,\n  isLocked,\n}\n","/**\n * Animation controller for ModalKit\n */\n\nimport type { AnimationState, AnimationType, AnimationController } from '../types'\n\n/**\n * Configuration for animation controller\n */\nexport interface AnimationControllerConfig {\n  /** Animation duration in ms */\n  duration: number\n  /** Called when animation state changes */\n  onStateChange?: (state: AnimationState) => void\n  /** Called when animation starts */\n  onAnimationStart?: (type: AnimationType) => void\n  /** Called when animation ends */\n  onAnimationEnd?: (type: AnimationType) => void\n}\n\n/**\n * Create an animation controller\n */\nexport function createAnimationController(\n  config: AnimationControllerConfig\n): AnimationController {\n  const { duration, onStateChange, onAnimationStart, onAnimationEnd } = config\n\n  let state: AnimationState = 'idle'\n  let timerId: ReturnType<typeof setTimeout> | null = null\n\n  function clearTimer(): void {\n    if (timerId !== null) {\n      clearTimeout(timerId)\n      timerId = null\n    }\n  }\n\n  function setState(newState: AnimationState): void {\n    if (state !== newState) {\n      state = newState\n      onStateChange?.(state)\n    }\n  }\n\n  function startEnter(): void {\n    clearTimer()\n    setState('entering')\n    onAnimationStart?.('enter')\n\n    timerId = setTimeout(() => {\n      setState('entered')\n      onAnimationEnd?.('enter')\n      timerId = null\n    }, duration)\n  }\n\n  function startExit(): void {\n    clearTimer()\n    setState('exiting')\n    onAnimationStart?.('exit')\n\n    timerId = setTimeout(() => {\n      setState('exited')\n      onAnimationEnd?.('exit')\n\n      // Transition to idle after exited\n      timerId = setTimeout(() => {\n        setState('idle')\n        timerId = null\n      }, 0)\n    }, duration)\n  }\n\n  function skipTo(targetState: 'entered' | 'exited'): void {\n    clearTimer()\n\n    if (targetState === 'entered') {\n      setState('entered')\n    } else {\n      setState('exited')\n      // Transition to idle\n      timerId = setTimeout(() => {\n        setState('idle')\n        timerId = null\n      }, 0)\n    }\n  }\n\n  function getState(): AnimationState {\n    return state\n  }\n\n  function isAnimating(): boolean {\n    return state === 'entering' || state === 'exiting'\n  }\n\n  function destroy(): void {\n    clearTimer()\n    state = 'idle'\n  }\n\n  return {\n    startEnter,\n    startExit,\n    skipTo,\n    getState,\n    isAnimating,\n    destroy,\n  }\n}\n\n/**\n * Create a no-op animation controller (for when animations are disabled)\n */\nexport function createNoopAnimationController(): AnimationController {\n  let state: AnimationState = 'idle'\n\n  return {\n    startEnter() {\n      state = 'entered'\n    },\n    startExit() {\n      state = 'idle'\n    },\n    skipTo(targetState: 'entered' | 'exited') {\n      state = targetState === 'entered' ? 'entered' : 'idle'\n    },\n    getState() {\n      return state\n    },\n    isAnimating() {\n      return false\n    },\n    destroy() {\n      state = 'idle'\n    },\n  }\n}\n","/**\n * Keyboard handling for ModalKit\n */\n\n/**\n * Check if event is Escape key\n */\nexport function isEscapeKey(event: KeyboardEvent): boolean {\n  return event.key === 'Escape' || event.key === 'Esc' || event.keyCode === 27\n}\n\n/**\n * Check if event is Tab key\n */\nexport function isTabKey(event: KeyboardEvent): boolean {\n  return event.key === 'Tab' || event.keyCode === 9\n}\n\n/**\n * Check if event is Enter key\n */\nexport function isEnterKey(event: KeyboardEvent): boolean {\n  return event.key === 'Enter' || event.keyCode === 13\n}\n\n/**\n * Check if event is Space key\n */\nexport function isSpaceKey(event: KeyboardEvent): boolean {\n  return event.key === ' ' || event.key === 'Spacebar' || event.keyCode === 32\n}\n\n/**\n * Configuration for keyboard handler\n */\nexport interface KeyboardHandlerConfig {\n  /** Close modal on Escape */\n  closeOnEscape: boolean\n  /** Callback when Escape is pressed */\n  onEscapeKeyDown?: (event: KeyboardEvent) => void\n  /** Close callback */\n  onClose: () => void\n  /** Whether this is the top-most modal */\n  isTopMost: () => boolean\n}\n\n/**\n * Create a keyboard event handler for modals\n */\nexport function createKeyboardHandler(\n  config: KeyboardHandlerConfig\n): (event: KeyboardEvent) => void {\n  const { closeOnEscape, onEscapeKeyDown, onClose, isTopMost } = config\n\n  return function handleKeyDown(event: KeyboardEvent): void {\n    // Only handle events for top-most modal\n    if (!isTopMost()) return\n\n    if (isEscapeKey(event)) {\n      // Call user callback first\n      onEscapeKeyDown?.(event)\n\n      // Close if enabled and event not prevented\n      if (closeOnEscape && !event.defaultPrevented) {\n        event.preventDefault()\n        event.stopPropagation()\n        onClose()\n      }\n    }\n  }\n}\n\n/**\n * Prevent default and stop propagation\n */\nexport function stopEvent(event: Event): void {\n  event.preventDefault()\n  event.stopPropagation()\n}\n","/**\n * Portal utilities for ModalKit\n */\n\nimport { getElement, createPortalContainer, removeElement } from '../utils/dom'\n\n// Default portal container ID\nconst DEFAULT_PORTAL_ID = 'modalkit-portal-root'\n\n/**\n * Get or create the default portal container\n */\nexport function getPortalContainer(\n  target?: HTMLElement | string | null\n): HTMLElement {\n  // If a specific target is provided, use it\n  if (target) {\n    const element = getElement(target)\n    if (element) return element\n  }\n\n  // Try to find existing default container\n  let container = document.getElementById(DEFAULT_PORTAL_ID)\n\n  // Create new container if doesn't exist\n  if (!container) {\n    container = createPortalContainer(DEFAULT_PORTAL_ID)\n    document.body.appendChild(container)\n  }\n\n  return container\n}\n\n/**\n * Create a new portal element\n */\nexport function createPortal(id?: string): HTMLDivElement {\n  return createPortalContainer(id)\n}\n\n/**\n * Append a portal element to a target\n */\nexport function appendPortal(\n  portal: HTMLElement,\n  target?: HTMLElement | string | null\n): void {\n  const container = getPortalContainer(target)\n  container.appendChild(portal)\n}\n\n/**\n * Remove a portal element from the DOM\n */\nexport function removePortal(portal: HTMLElement | null): void {\n  removeElement(portal)\n}\n\n/**\n * Clean up all modalkit portals from the DOM\n */\nexport function cleanupPortals(): void {\n  const portals = document.querySelectorAll('[data-modalkit-portal]')\n  portals.forEach((portal) => portal.remove())\n\n  // Also remove the default container if empty\n  const defaultContainer = document.getElementById(DEFAULT_PORTAL_ID)\n  if (defaultContainer && defaultContainer.children.length === 0) {\n    defaultContainer.remove()\n  }\n}\n","/**\n * ID generation utilities for ModalKit\n */\n\nlet counter = 0\n\n/**\n * Generate a unique ID with optional prefix\n */\nexport function generateId(prefix: string = 'modalkit'): string {\n  counter++\n  return `${prefix}-${counter}`\n}\n\n/**\n * Create a namespaced ID generator\n */\nexport function createIdGenerator(namespace: string): () => string {\n  let localCounter = 0\n\n  return function generateNamespacedId(): string {\n    localCounter++\n    return `${namespace}-${localCounter}`\n  }\n}\n\n/**\n * Reset the global counter (useful for testing)\n */\nexport function resetIdCounter(): void {\n  counter = 0\n}\n\n/**\n * Create modal-specific IDs\n */\nexport function createModalIds(baseId: string): {\n  modalId: string\n  titleId: string\n  descriptionId: string\n} {\n  return {\n    modalId: baseId,\n    titleId: `${baseId}-title`,\n    descriptionId: `${baseId}-description`,\n  }\n}\n","/**\n * Main modal factory for ModalKit\n */\n\nimport type {\n  Modal,\n  ModalConfig,\n  ModalState,\n  ModalInternal,\n  AnimationState,\n  PortalProps,\n  OverlayProps,\n  ContainerProps,\n  ContentProps,\n  TitleProps,\n  DescriptionProps,\n  CloseButtonProps,\n  TriggerProps,\n  FocusTrap,\n} from '../types'\n\nimport { mergeConfig, DEFAULT_CONFIG } from './config'\nimport { createInitialState, createStateManager, shouldBeMounted } from './state'\nimport { stackInternal, calculateZIndex } from './stack'\nimport { createFocusTrap } from '../features/focus-trap'\nimport { scrollLock } from '../features/scroll-lock'\nimport {\n  createAnimationController,\n  createNoopAnimationController,\n} from '../features/animation'\nimport { createKeyboardHandler } from '../features/keyboard'\nimport { getPortalContainer } from '../features/portal'\nimport { generateId, createModalIds } from '../utils/id'\nimport { contains as domContains } from '../utils/dom'\nimport {\n  saveFocus,\n  restoreFocus,\n  focusElement,\n  getFirstFocusable,\n  getLastFocusable,\n} from '../utils/focus'\n\n/**\n * Create a new modal instance\n */\nexport function createModal(userConfig?: ModalConfig): Modal {\n  // Merge config with defaults\n  const config = mergeConfig(userConfig)\n\n  // Generate IDs\n  const baseId = config.id ?? generateId('modal')\n  const ids = createModalIds(baseId)\n\n  // Initialize state\n  const initialOpen = config.open ?? config.defaultOpen ?? false\n  const stateManager = createStateManager(createInitialState(initialOpen))\n\n  // Animation controller\n  const animationController = config.animated\n    ? createAnimationController({\n        duration: config.animationDuration ?? DEFAULT_CONFIG.animationDuration,\n        onStateChange: (animationState) => {\n          stateManager.setState({\n            animationState,\n            mounted: shouldBeMounted(stateManager.getState().open, animationState),\n          })\n        },\n        onAnimationStart: config.onAnimationStart,\n        onAnimationEnd: config.onAnimationEnd,\n      })\n    : createNoopAnimationController()\n\n  // Focus trap (created lazily)\n  let focusTrap: FocusTrap | null = null\n  let contentElement: HTMLElement | null = null\n  let overlayElement: HTMLElement | null = null\n  let containerElement: HTMLElement | null = null\n\n  // Keyboard handler\n  const handleKeyDown = createKeyboardHandler({\n    closeOnEscape: config.closeOnEscape ?? DEFAULT_CONFIG.closeOnEscape,\n    onEscapeKeyDown: config.onEscapeKeyDown,\n    onClose: () => close(),\n    isTopMost: () => stateManager.getState().isTopMost,\n  })\n\n  // ============ INTERNAL METHODS ============\n\n  function resolveElement(\n    ref: HTMLElement | (() => HTMLElement | null) | null | undefined\n  ): HTMLElement | null {\n    if (!ref) return null\n    if (typeof ref === 'function') return ref()\n    return ref\n  }\n\n  function setupFocusTrap(): void {\n    if (!contentElement || focusTrap) return\n    if (!config.trapFocus) return\n\n    focusTrap = createFocusTrap({\n      container: contentElement,\n      initialFocus: resolveElement(config.initialFocusRef),\n      returnFocus: resolveElement(config.finalFocusRef),\n      escapeDeactivates: false, // We handle escape ourselves\n      clickOutsideDeactivates: false,\n    })\n  }\n\n  function teardownFocusTrap(): void {\n    if (focusTrap) {\n      focusTrap.deactivate()\n      focusTrap = null\n    }\n  }\n\n  function activateFocusTrap(): void {\n    // Create focus trap if needed\n    if (!focusTrap && config.trapFocus && contentElement) {\n      setupFocusTrap()\n    }\n\n    // Activate if exists and not active\n    if (focusTrap && !focusTrap.isActive()) {\n      focusTrap.activate()\n    }\n  }\n\n  function handleOpen(): void {\n    const state = stateManager.getState()\n    if (state.open) return\n\n    // Save focus before opening\n    if (config.restoreFocus) {\n      saveFocus()\n    }\n\n    // Update state\n    stateManager.setState({ open: true, mounted: true })\n\n    // Start animation\n    if (config.animated) {\n      animationController.startEnter()\n    } else {\n      stateManager.setState({ animationState: 'entered' })\n    }\n\n    // Add to stack\n    stackInternal.push(modal as ModalInternal)\n\n    // Lock scroll\n    if (config.preventScroll) {\n      scrollLock.lock()\n    }\n\n    // Callbacks\n    config.onOpen?.()\n    config.onOpenChange?.(true)\n\n    // Focus trap will be activated when content is mounted\n    // (via ref callback in getContentProps)\n  }\n\n  function handleClose(): void {\n    const state = stateManager.getState()\n    if (!state.open) return\n\n    // Update state\n    stateManager.setState({ open: false })\n\n    // Start animation\n    if (config.animated) {\n      animationController.startExit()\n    } else {\n      stateManager.setState({ animationState: 'idle', mounted: false })\n    }\n\n    // Remove from stack\n    stackInternal.remove(modal as ModalInternal)\n\n    // Deactivate focus trap\n    teardownFocusTrap()\n\n    // Unlock scroll\n    if (config.preventScroll) {\n      scrollLock.unlock()\n    }\n\n    // Restore focus\n    if (config.restoreFocus) {\n      const finalFocus = resolveElement(config.finalFocusRef)\n      if (finalFocus) {\n        focusElement(finalFocus)\n      } else {\n        restoreFocus()\n      }\n    }\n\n    // Callbacks\n    config.onClose?.()\n    config.onOpenChange?.(false)\n  }\n\n  function handleOverlayClick(e: MouseEvent): void {\n    // Only close if clicking directly on overlay/container, not content\n    const target = e.target as HTMLElement\n    const isOverlay = target === overlayElement || target === containerElement\n\n    if (!isOverlay) return\n\n    config.onOverlayClick?.(e)\n\n    if (config.closeOnOverlayClick && !e.defaultPrevented) {\n      close()\n    }\n  }\n\n  // ============ PUBLIC API ============\n\n  function isOpen(): boolean {\n    return stateManager.getState().open\n  }\n\n  function isMounted(): boolean {\n    return stateManager.getState().mounted\n  }\n\n  function getState(): ModalState {\n    return stateManager.getState()\n  }\n\n  function subscribe(callback: (state: ModalState) => void): () => void {\n    return stateManager.subscribe(callback)\n  }\n\n  function open(): void {\n    handleOpen()\n  }\n\n  function close(): void {\n    handleClose()\n  }\n\n  function toggle(): void {\n    if (isOpen()) {\n      close()\n    } else {\n      open()\n    }\n  }\n\n  function getStackOrder(): number {\n    return stateManager.getState().stackOrder\n  }\n\n  function isTopMost(): boolean {\n    return stateManager.getState().isTopMost\n  }\n\n  function isAnimating(): boolean {\n    return animationController.isAnimating()\n  }\n\n  function getAnimationState(): AnimationState {\n    return stateManager.getState().animationState\n  }\n\n  function focusFirst(): void {\n    if (!contentElement) return\n    const first = getFirstFocusable(contentElement)\n    if (first) focusElement(first)\n  }\n\n  function focusLast(): void {\n    if (!contentElement) return\n    const last = getLastFocusable(contentElement)\n    if (last) focusElement(last)\n  }\n\n  function contains(element: Element | null): boolean {\n    return domContains(contentElement, element)\n  }\n\n  function getPortalTarget(): HTMLElement {\n    return getPortalContainer(config.portalTarget)\n  }\n\n  // ============ PROPS GETTERS ============\n\n  function getPortalProps(): PortalProps {\n    return {\n      'data-modalkit-portal': '',\n      'data-state': getAnimationState(),\n    }\n  }\n\n  function getOverlayProps(): OverlayProps {\n    const state = getState()\n    const zIndex = calculateZIndex(state.stackOrder)\n\n    return {\n      ref: (el) => {\n        overlayElement = el\n      },\n      'data-modalkit-overlay': '',\n      'data-state': state.animationState,\n      style: {\n        position: 'fixed',\n        inset: '0',\n        zIndex,\n      },\n      onClick: handleOverlayClick,\n    }\n  }\n\n  function getContainerProps(): ContainerProps {\n    const state = getState()\n    const zIndex = calculateZIndex(state.stackOrder) + 1\n    const scrollBehavior = config.scrollBehavior ?? DEFAULT_CONFIG.scrollBehavior\n\n    return {\n      ref: (el) => {\n        containerElement = el\n      },\n      'data-modalkit-container': '',\n      'data-state': state.animationState,\n      style: {\n        position: 'fixed',\n        inset: '0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex,\n        overflow: scrollBehavior === 'inside' ? 'auto' : 'hidden',\n      },\n      onClick: handleOverlayClick,\n    }\n  }\n\n  function getContentProps(): ContentProps {\n    const state = getState()\n\n    const props: ContentProps = {\n      ref: (el) => {\n        const wasNull = contentElement === null\n        contentElement = el\n\n        // Setup and activate focus trap when content is mounted\n        if (el && wasNull && state.open) {\n          setupFocusTrap()\n          if (config.autoFocus) {\n            // Delay to ensure element is in DOM\n            requestAnimationFrame(() => {\n              activateFocusTrap()\n            })\n          }\n        }\n      },\n      role: config.role ?? DEFAULT_CONFIG.role,\n      'aria-modal': true,\n      'data-modalkit-content': '',\n      'data-state': state.animationState,\n      tabIndex: -1,\n      onKeyDown: handleKeyDown,\n    }\n\n    // Add aria attributes\n    if (config.ariaLabel) {\n      props['aria-label'] = config.ariaLabel\n    } else if (config.ariaLabelledBy) {\n      props['aria-labelledby'] = config.ariaLabelledBy\n    } else {\n      // Default to title ID\n      props['aria-labelledby'] = ids.titleId\n    }\n\n    if (config.ariaDescribedBy) {\n      props['aria-describedby'] = config.ariaDescribedBy\n    } else {\n      props['aria-describedby'] = ids.descriptionId\n    }\n\n    return props\n  }\n\n  function getTitleProps(customId?: string): TitleProps {\n    return {\n      id: customId ?? ids.titleId,\n      'data-modalkit-title': '',\n    }\n  }\n\n  function getDescriptionProps(customId?: string): DescriptionProps {\n    return {\n      id: customId ?? ids.descriptionId,\n      'data-modalkit-description': '',\n    }\n  }\n\n  function getCloseButtonProps(): CloseButtonProps {\n    return {\n      type: 'button',\n      'aria-label': 'Close',\n      'data-modalkit-close': '',\n      onClick: () => close(),\n    }\n  }\n\n  function getTriggerProps(): TriggerProps {\n    return {\n      type: 'button',\n      'aria-haspopup': 'dialog',\n      'aria-expanded': isOpen(),\n      'data-modalkit-trigger': '',\n      onClick: () => open(),\n    }\n  }\n\n  function getConfig(): ModalConfig {\n    return { ...config }\n  }\n\n  function setConfig(newConfig: Partial<ModalConfig>): void {\n    Object.assign(config, newConfig)\n  }\n\n  function destroy(): void {\n    if (isOpen()) {\n      close()\n    }\n    teardownFocusTrap()\n    animationController.destroy()\n    contentElement = null\n    overlayElement = null\n    containerElement = null\n  }\n\n  // ============ INTERNAL INTERFACE ============\n\n  const modal: ModalInternal = {\n    // Public API\n    isOpen,\n    isMounted,\n    getState,\n    subscribe,\n    open,\n    close,\n    toggle,\n    getStackOrder,\n    isTopMost,\n    isAnimating,\n    getAnimationState,\n    focusFirst,\n    focusLast,\n    contains,\n    getPortalTarget,\n    getPortalProps,\n    getOverlayProps,\n    getContainerProps,\n    getContentProps,\n    getTitleProps,\n    getDescriptionProps,\n    getCloseButtonProps,\n    getTriggerProps,\n    getConfig,\n    setConfig,\n    destroy,\n\n    // Internal API\n    _id: baseId,\n    _getTitleId: () => ids.titleId,\n    _getDescriptionId: () => ids.descriptionId,\n    _setStackOrder: (order) => stateManager.setState({ stackOrder: order }),\n    _setIsTopMost: (isTop) => stateManager.setState({ isTopMost: isTop }),\n    _getContentElement: () => contentElement,\n    _handleOverlayClick: handleOverlayClick,\n    _handleKeyDown: handleKeyDown,\n  }\n\n  // Open if defaultOpen is true\n  if (initialOpen) {\n    stackInternal.push(modal)\n  }\n\n  return modal\n}\n","/**\n * Base utilities for dialog implementations\n */\n\nimport { createModal } from '../core/modal'\nimport type { ModalConfig } from '../types'\n\n/**\n * Dialog variant types\n */\nexport type DialogVariant =\n  | 'default'\n  | 'primary'\n  | 'danger'\n  | 'warning'\n  | 'success'\n  | 'error'\n  | 'info'\n\n/**\n * Create dialog container elements\n */\nexport function createDialogElements(modal: ReturnType<typeof createModal>): {\n  portal: HTMLDivElement\n  overlay: HTMLDivElement\n  container: HTMLDivElement\n  content: HTMLDivElement\n} {\n  const portal = document.createElement('div')\n  const portalProps = modal.getPortalProps()\n  portal.setAttribute('data-modalkit-portal', portalProps['data-modalkit-portal'])\n  portal.setAttribute('data-state', portalProps['data-state'])\n\n  const overlay = document.createElement('div')\n  const overlayProps = modal.getOverlayProps()\n  overlay.setAttribute('data-modalkit-overlay', '')\n  overlay.setAttribute('data-state', overlayProps['data-state'])\n  Object.assign(overlay.style, overlayProps.style)\n  overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.5)'\n  overlayProps.ref(overlay)\n\n  const container = document.createElement('div')\n  const containerProps = modal.getContainerProps()\n  container.setAttribute('data-modalkit-container', '')\n  container.setAttribute('data-state', containerProps['data-state'])\n  Object.assign(container.style, containerProps.style)\n  containerProps.ref(container)\n\n  const content = document.createElement('div')\n  const contentProps = modal.getContentProps()\n  content.setAttribute('role', contentProps.role)\n  content.setAttribute('aria-modal', 'true')\n  if (contentProps['aria-labelledby']) {\n    content.setAttribute('aria-labelledby', contentProps['aria-labelledby'])\n  }\n  if (contentProps['aria-describedby']) {\n    content.setAttribute('aria-describedby', contentProps['aria-describedby'])\n  }\n  content.setAttribute('data-modalkit-content', '')\n  content.setAttribute('data-state', contentProps['data-state'])\n  content.setAttribute('tabindex', '-1')\n  content.style.backgroundColor = 'white'\n  content.style.borderRadius = '8px'\n  content.style.padding = '24px'\n  content.style.maxWidth = '400px'\n  content.style.width = '100%'\n  content.style.boxShadow = '0 25px 50px -12px rgba(0, 0, 0, 0.25)'\n  contentProps.ref(content)\n\n  // Add keyboard handler\n  content.addEventListener('keydown', (e) => {\n    contentProps.onKeyDown(e)\n  })\n\n  // Assemble\n  container.appendChild(content)\n  overlay.appendChild(container)\n  portal.appendChild(overlay)\n\n  return { portal, overlay, container, content }\n}\n\n/**\n * Create a dialog modal with common configuration\n */\nexport function createDialogModal(\n  customConfig?: Partial<ModalConfig>\n): ReturnType<typeof createModal> {\n  return createModal({\n    closeOnOverlayClick: false,\n    closeOnEscape: true,\n    trapFocus: true,\n    preventScroll: true,\n    role: 'alertdialog',\n    animated: false,\n    ...customConfig,\n  })\n}\n\n/**\n * Apply styles for a button\n */\nexport function styleButton(\n  button: HTMLButtonElement,\n  variant: DialogVariant = 'default'\n): void {\n  button.style.padding = '8px 16px'\n  button.style.borderRadius = '6px'\n  button.style.border = 'none'\n  button.style.cursor = 'pointer'\n  button.style.fontWeight = '500'\n  button.style.fontSize = '14px'\n  button.style.transition = 'background-color 0.2s'\n\n  switch (variant) {\n    case 'primary':\n      button.style.backgroundColor = '#3b82f6'\n      button.style.color = 'white'\n      break\n    case 'danger':\n    case 'error':\n      button.style.backgroundColor = '#ef4444'\n      button.style.color = 'white'\n      break\n    case 'warning':\n      button.style.backgroundColor = '#f59e0b'\n      button.style.color = 'white'\n      break\n    case 'success':\n      button.style.backgroundColor = '#10b981'\n      button.style.color = 'white'\n      break\n    case 'info':\n      button.style.backgroundColor = '#3b82f6'\n      button.style.color = 'white'\n      break\n    default:\n      button.style.backgroundColor = '#e5e7eb'\n      button.style.color = '#374151'\n  }\n}\n\n/**\n * Create dialog title element\n */\nexport function createTitleElement(\n  title: string,\n  modal: ReturnType<typeof createModal>\n): HTMLHeadingElement {\n  const titleProps = modal.getTitleProps()\n  const titleEl = document.createElement('h2')\n  titleEl.id = titleProps.id\n  titleEl.setAttribute('data-modalkit-title', '')\n  titleEl.textContent = title\n  titleEl.style.margin = '0 0 8px 0'\n  titleEl.style.fontSize = '18px'\n  titleEl.style.fontWeight = '600'\n  titleEl.style.color = '#111827'\n  return titleEl\n}\n\n/**\n * Create dialog message element\n */\nexport function createMessageElement(\n  message: string,\n  modal: ReturnType<typeof createModal>\n): HTMLParagraphElement {\n  const descProps = modal.getDescriptionProps()\n  const messageEl = document.createElement('p')\n  messageEl.id = descProps.id\n  messageEl.setAttribute('data-modalkit-description', '')\n  messageEl.textContent = message\n  messageEl.style.margin = '0 0 24px 0'\n  messageEl.style.fontSize = '14px'\n  messageEl.style.color = '#6b7280'\n  messageEl.style.lineHeight = '1.5'\n  return messageEl\n}\n\n/**\n * Create button container\n */\nexport function createButtonContainer(): HTMLDivElement {\n  const container = document.createElement('div')\n  container.style.display = 'flex'\n  container.style.justifyContent = 'flex-end'\n  container.style.gap = '8px'\n  return container\n}\n","/**\n * Confirm dialog implementation\n */\n\nimport type { ConfirmOptions, ConfirmOptionsAdvanced, ConfirmButton } from '../types'\nimport {\n  createDialogModal,\n  createDialogElements,\n  createTitleElement,\n  createMessageElement,\n  createButtonContainer,\n  styleButton,\n} from './base'\n\n/**\n * Default confirm options\n */\nconst DEFAULT_OPTIONS: Required<Omit<ConfirmOptions, 'title'>> = {\n  message: '',\n  confirmText: 'Confirm',\n  cancelText: 'Cancel',\n  variant: 'default',\n  closeOnOverlayClick: false,\n  closeOnEscape: true,\n}\n\n/**\n * Show a confirm dialog\n */\nexport function confirm(message: string): Promise<boolean>\nexport function confirm(options: ConfirmOptions): Promise<boolean>\nexport function confirm(options: ConfirmOptionsAdvanced): Promise<string | boolean>\nexport function confirm(\n  messageOrOptions: string | ConfirmOptions | ConfirmOptionsAdvanced\n): Promise<boolean | string> {\n  return new Promise((resolve) => {\n    // Normalize options\n    const options: ConfirmOptionsAdvanced =\n      typeof messageOrOptions === 'string'\n        ? { message: messageOrOptions }\n        : messageOrOptions\n\n    const {\n      title,\n      message,\n      confirmText = DEFAULT_OPTIONS.confirmText,\n      cancelText = DEFAULT_OPTIONS.cancelText,\n      variant = DEFAULT_OPTIONS.variant,\n      closeOnOverlayClick = DEFAULT_OPTIONS.closeOnOverlayClick,\n      closeOnEscape = DEFAULT_OPTIONS.closeOnEscape,\n      buttons,\n    } = options\n\n    // Track if resolved\n    let resolved = false\n\n    // Create modal\n    const modal = createDialogModal({\n      closeOnOverlayClick,\n      closeOnEscape,\n      onClose: () => {\n        if (!resolved) {\n          resolved = true\n          resolve(false)\n        }\n        cleanup()\n      },\n    })\n\n    // Create elements\n    const { portal, content } = createDialogElements(modal)\n\n    // Add title if provided\n    if (title) {\n      content.appendChild(createTitleElement(title, modal))\n    }\n\n    // Add message\n    content.appendChild(createMessageElement(message, modal))\n\n    // Create button container\n    const buttonContainer = createButtonContainer()\n\n    // Determine buttons to show\n    const buttonsToRender: ConfirmButton[] = buttons ?? [\n      { text: cancelText, value: false, variant: 'default' },\n      { text: confirmText, value: true, variant: variant === 'default' ? 'primary' : variant, autoFocus: true },\n    ]\n\n    // Create buttons\n    let autoFocusButton: HTMLButtonElement | null = null\n\n    buttonsToRender.forEach((btnConfig) => {\n      const button = document.createElement('button')\n      button.textContent = btnConfig.text\n      button.type = 'button'\n      styleButton(button, btnConfig.variant)\n\n      button.addEventListener('click', () => {\n        resolved = true\n        modal.close()\n        resolve(btnConfig.value)\n      })\n\n      if (btnConfig.autoFocus) {\n        autoFocusButton = button\n      }\n\n      buttonContainer.appendChild(button)\n    })\n\n    content.appendChild(buttonContainer)\n\n    // Cleanup function\n    function cleanup(): void {\n      modal.destroy()\n      portal.remove()\n    }\n\n    // Mount and open\n    document.body.appendChild(portal)\n    modal.open()\n\n    // Focus the auto-focus button\n    if (autoFocusButton) {\n      requestAnimationFrame(() => {\n        autoFocusButton?.focus()\n      })\n    }\n  })\n}\n","/**\n * Alert dialog implementation\n */\n\nimport type { AlertOptions } from '../types'\nimport {\n  createDialogModal,\n  createDialogElements,\n  createTitleElement,\n  createMessageElement,\n  createButtonContainer,\n  styleButton,\n  type DialogVariant,\n} from './base'\n\n/**\n * Default alert options\n */\nconst DEFAULT_OPTIONS: Required<Omit<AlertOptions, 'title'>> = {\n  message: '',\n  confirmText: 'OK',\n  variant: 'default',\n}\n\n/**\n * Map alert variants to button variants\n */\nfunction getButtonVariant(alertVariant: AlertOptions['variant']): DialogVariant {\n  switch (alertVariant) {\n    case 'success':\n      return 'success'\n    case 'warning':\n      return 'warning'\n    case 'error':\n      return 'danger'\n    case 'info':\n      return 'info'\n    default:\n      return 'primary'\n  }\n}\n\n/**\n * Show an alert dialog\n */\nexport function alert(message: string): Promise<void>\nexport function alert(options: AlertOptions): Promise<void>\nexport function alert(messageOrOptions: string | AlertOptions): Promise<void> {\n  return new Promise((resolve) => {\n    // Normalize options\n    const options: AlertOptions =\n      typeof messageOrOptions === 'string'\n        ? { message: messageOrOptions }\n        : messageOrOptions\n\n    const {\n      title,\n      message,\n      confirmText = DEFAULT_OPTIONS.confirmText,\n      variant = DEFAULT_OPTIONS.variant,\n    } = options\n\n    // Create modal\n    const modal = createDialogModal({\n      closeOnOverlayClick: false,\n      closeOnEscape: true,\n      onClose: () => {\n        resolve()\n        cleanup()\n      },\n    })\n\n    // Create elements\n    const { portal, content } = createDialogElements(modal)\n\n    // Add title if provided\n    if (title) {\n      content.appendChild(createTitleElement(title, modal))\n    }\n\n    // Add message\n    content.appendChild(createMessageElement(message, modal))\n\n    // Create button container\n    const buttonContainer = createButtonContainer()\n\n    // Create confirm button\n    const confirmButton = document.createElement('button')\n    confirmButton.textContent = confirmText\n    confirmButton.type = 'button'\n    styleButton(confirmButton, getButtonVariant(variant))\n\n    confirmButton.addEventListener('click', () => {\n      modal.close()\n    })\n\n    buttonContainer.appendChild(confirmButton)\n    content.appendChild(buttonContainer)\n\n    // Cleanup function\n    function cleanup(): void {\n      modal.destroy()\n      portal.remove()\n    }\n\n    // Mount and open\n    document.body.appendChild(portal)\n    modal.open()\n\n    // Focus the confirm button\n    requestAnimationFrame(() => {\n      confirmButton.focus()\n    })\n  })\n}\n","/**\n * Prompt dialog implementation\n */\n\nimport type { PromptOptions } from '../types'\nimport {\n  createDialogModal,\n  createDialogElements,\n  createTitleElement,\n  createMessageElement,\n  createButtonContainer,\n  styleButton,\n} from './base'\n\n/**\n * Default prompt options\n */\nconst DEFAULT_OPTIONS: Required<\n  Omit<PromptOptions, 'title' | 'message' | 'validate'>\n> = {\n  placeholder: '',\n  defaultValue: '',\n  confirmText: 'OK',\n  cancelText: 'Cancel',\n  type: 'text',\n  required: false,\n  minLength: 0,\n  maxLength: Infinity,\n}\n\n/**\n * Show a prompt dialog\n */\nexport function prompt(message: string): Promise<string | null>\nexport function prompt(options: PromptOptions): Promise<string | null>\nexport function prompt(\n  messageOrOptions: string | PromptOptions\n): Promise<string | null> {\n  return new Promise((resolve) => {\n    // Normalize options\n    const options: PromptOptions =\n      typeof messageOrOptions === 'string'\n        ? { message: messageOrOptions }\n        : messageOrOptions\n\n    const {\n      title,\n      message,\n      placeholder = DEFAULT_OPTIONS.placeholder,\n      defaultValue = DEFAULT_OPTIONS.defaultValue,\n      confirmText = DEFAULT_OPTIONS.confirmText,\n      cancelText = DEFAULT_OPTIONS.cancelText,\n      type = DEFAULT_OPTIONS.type,\n      validate,\n      required = DEFAULT_OPTIONS.required,\n      minLength = DEFAULT_OPTIONS.minLength,\n      maxLength = DEFAULT_OPTIONS.maxLength,\n    } = options\n\n    // Track if resolved\n    let resolved = false\n\n    // Create modal\n    const modal = createDialogModal({\n      closeOnOverlayClick: false,\n      closeOnEscape: true,\n      onClose: () => {\n        if (!resolved) {\n          resolved = true\n          resolve(null)\n        }\n        cleanup()\n      },\n    })\n\n    // Create elements\n    const { portal, content } = createDialogElements(modal)\n\n    // Add title if provided\n    if (title) {\n      content.appendChild(createTitleElement(title, modal))\n    }\n\n    // Add message if provided\n    if (message) {\n      content.appendChild(createMessageElement(message, modal))\n    }\n\n    // Create input container\n    const inputContainer = document.createElement('div')\n    inputContainer.style.marginBottom = '16px'\n\n    // Create input\n    const input = document.createElement('input')\n    input.type = type\n    input.value = defaultValue\n    if (placeholder) input.placeholder = placeholder\n    if (required) input.required = true\n    if (minLength > 0) input.minLength = minLength\n    if (maxLength < Infinity) input.maxLength = maxLength\n\n    input.style.width = '100%'\n    input.style.padding = '8px 12px'\n    input.style.border = '1px solid #d1d5db'\n    input.style.borderRadius = '6px'\n    input.style.fontSize = '14px'\n    input.style.outline = 'none'\n    input.style.boxSizing = 'border-box'\n\n    input.addEventListener('focus', () => {\n      input.style.borderColor = '#3b82f6'\n      input.style.boxShadow = '0 0 0 3px rgba(59, 130, 246, 0.1)'\n    })\n\n    input.addEventListener('blur', () => {\n      input.style.borderColor = '#d1d5db'\n      input.style.boxShadow = 'none'\n    })\n\n    // Create error message element\n    const errorEl = document.createElement('p')\n    errorEl.style.color = '#ef4444'\n    errorEl.style.fontSize = '12px'\n    errorEl.style.marginTop = '4px'\n    errorEl.style.marginBottom = '0'\n    errorEl.style.display = 'none'\n\n    inputContainer.appendChild(input)\n    inputContainer.appendChild(errorEl)\n    content.appendChild(inputContainer)\n\n    // Validation function\n    function validateInput(): boolean | string {\n      const value = input.value\n\n      // Required check\n      if (required && !value.trim()) {\n        return 'This field is required'\n      }\n\n      // Min length check\n      if (minLength > 0 && value.length < minLength) {\n        return `Minimum ${minLength} characters required`\n      }\n\n      // Max length check\n      if (maxLength < Infinity && value.length > maxLength) {\n        return `Maximum ${maxLength} characters allowed`\n      }\n\n      // Custom validation\n      if (validate) {\n        return validate(value)\n      }\n\n      return true\n    }\n\n    function showError(message: string): void {\n      errorEl.textContent = message\n      errorEl.style.display = 'block'\n      input.style.borderColor = '#ef4444'\n    }\n\n    function clearError(): void {\n      errorEl.style.display = 'none'\n      input.style.borderColor = '#d1d5db'\n    }\n\n    function handleSubmit(): void {\n      clearError()\n      const validationResult = validateInput()\n\n      if (validationResult !== true) {\n        const errorMessage =\n          typeof validationResult === 'string'\n            ? validationResult\n            : 'Invalid input'\n        showError(errorMessage)\n        input.focus()\n        return\n      }\n\n      resolved = true\n      modal.close()\n      resolve(input.value)\n    }\n\n    // Handle Enter key\n    input.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault()\n        handleSubmit()\n      }\n    })\n\n    // Clear error on input\n    input.addEventListener('input', clearError)\n\n    // Create button container\n    const buttonContainer = createButtonContainer()\n\n    // Cancel button\n    const cancelButton = document.createElement('button')\n    cancelButton.textContent = cancelText\n    cancelButton.type = 'button'\n    styleButton(cancelButton, 'default')\n\n    cancelButton.addEventListener('click', () => {\n      resolved = true\n      modal.close()\n      resolve(null)\n    })\n\n    // Confirm button\n    const confirmButton = document.createElement('button')\n    confirmButton.textContent = confirmText\n    confirmButton.type = 'button'\n    styleButton(confirmButton, 'primary')\n\n    confirmButton.addEventListener('click', handleSubmit)\n\n    buttonContainer.appendChild(cancelButton)\n    buttonContainer.appendChild(confirmButton)\n    content.appendChild(buttonContainer)\n\n    // Cleanup function\n    function cleanup(): void {\n      modal.destroy()\n      portal.remove()\n    }\n\n    // Mount and open\n    document.body.appendChild(portal)\n    modal.open()\n\n    // Focus the input\n    requestAnimationFrame(() => {\n      input.focus()\n      // Select default value\n      if (defaultValue) {\n        input.select()\n      }\n    })\n  })\n}\n"]}