{"version":3,"sources":["../src/core/config.ts","../src/utils/events.ts","../src/core/state.ts","../src/core/stack.ts","../src/utils/focus.ts","../src/features/focus-trap.ts","../src/utils/dom.ts","../src/features/scroll-lock.ts","../src/features/animation.ts","../src/features/keyboard.ts","../src/features/portal.ts","../src/utils/id.ts","../src/core/modal.ts","../src/dialogs/base.ts","../src/dialogs/confirm.ts","../src/dialogs/alert.ts","../src/dialogs/prompt.ts"],"names":["DEFAULT_CONFIG","mergeConfig","config","createEventEmitter","listeners","on","event","handler","off","handlers","emit","args","error","clear","createSubscriptionManager","subscribers","subscribe","callback","notify","value","createInitialState","defaultOpen","createStateManager","initialState","state","getState","setState","partial","prevState","hasStateChanged","prev","next","shouldBeMounted","open","animationState","BASE_Z_INDEX","Z_INDEX_INCREMENT","calculateZIndex","stackOrder","createModalStack","stack","events","updateStackState","modal","index","order","isTopMost","push","remove","count","isEmpty","getAll","getTopMost","getByOrder","closeAll","closeTopMost","topMost","modalStack","stackInternal","FOCUSABLE_SELECTOR","isVisible","element","style","isFocusable","getFocusableElements","container","elements","getFirstFocusable","getLastFocusable","focusables","getActiveElement","doc","activeElement","focusElement","options","savedFocus","saveFocus","restoreFocus","preventScroll","scrollX","scrollY","createFocusTrap","initialFocus","fallbackFocus","returnFocus","escapeDeactivates","clickOutsideDeactivates","allowOutsideClick","onActivate","onDeactivate","active","paused","focusing","resolveElement","ref","handleKeyDown","firstFocusable","lastFocusable","handleEscapeKey","deactivate","handleClick","target","handleFocusIn","activate","initialElement","fallbackElement","elementToFocus","returnElement","pause","unpause","isActive","isPaused","getElement","createPortalContainer","id","removeElement","getScrollbarWidth","outer","inner","scrollbarWidth","contains","parent","child","lockCount","originalStyles","isIOS","getScrollPosition","scrollPosition","lock","hasScrollbar","currentPadding","unlock","isLocked","scrollLock","createAnimationController","duration","onStateChange","onAnimationStart","onAnimationEnd","timerId","clearTimer","newState","startEnter","startExit","skipTo","targetState","isAnimating","destroy","createNoopAnimationController","isEscapeKey","createKeyboardHandler","closeOnEscape","onEscapeKeyDown","onClose","DEFAULT_PORTAL_ID","getPortalContainer","counter","generateId","prefix","createModalIds","baseId","createModal","userConfig","ids","initialOpen","stateManager","animationController","focusTrap","contentElement","overlayElement","containerElement","close","setupFocusTrap","teardownFocusTrap","activateFocusTrap","handleOpen","handleClose","finalFocus","handleOverlayClick","e","isOpen","isMounted","toggle","getStackOrder","getAnimationState","focusFirst","first","focusLast","last","getPortalTarget","getPortalProps","getOverlayProps","zIndex","el","getContainerProps","scrollBehavior","getContentProps","props","wasNull","getTitleProps","customId","getDescriptionProps","getCloseButtonProps","getTriggerProps","getConfig","setConfig","newConfig","isTop","createDialogElements","portal","portalProps","overlay","overlayProps","containerProps","content","contentProps","createDialogModal","customConfig","styleButton","button","variant","createTitleElement","title","titleProps","titleEl","createMessageElement","message","descProps","messageEl","createButtonContainer","DEFAULT_OPTIONS","confirm","messageOrOptions","resolve","confirmText","cancelText","closeOnOverlayClick","buttons","resolved","cleanup","buttonContainer","buttonsToRender","autoFocusButton","btnConfig","getButtonVariant","alertVariant","alert","confirmButton","prompt","placeholder","defaultValue","type","validate","required","minLength","maxLength","inputContainer","input","errorEl","validateInput","showError","clearError","handleSubmit","validationResult","cancelButton"],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * Default configuration and config utilities for ModalKit\r\n */\r\n\r\nimport type { ModalConfig } from '../types'\r\n\r\n/**\r\n * Default modal configuration\r\n */\r\nexport const DEFAULT_CONFIG: Required<\r\n  Omit<\r\n    ModalConfig,\r\n    | 'open'\r\n    | 'initialFocusRef'\r\n    | 'finalFocusRef'\r\n    | 'portalTarget'\r\n    | 'id'\r\n    | 'ariaLabel'\r\n    | 'ariaLabelledBy'\r\n    | 'ariaDescribedBy'\r\n    | 'onOpen'\r\n    | 'onClose'\r\n    | 'onOpenChange'\r\n    | 'onAnimationStart'\r\n    | 'onAnimationEnd'\r\n    | 'onEscapeKeyDown'\r\n    | 'onOverlayClick'\r\n  >\r\n> = {\r\n  defaultOpen: false,\r\n  closeOnOverlayClick: true,\r\n  closeOnEscape: true,\r\n  preventScroll: true,\r\n  scrollBehavior: 'inside',\r\n  trapFocus: true,\r\n  autoFocus: true,\r\n  restoreFocus: true,\r\n  stackable: true,\r\n  closeOnStackedOpen: false,\r\n  animated: false,\r\n  animationDuration: 200,\r\n  disablePortal: false,\r\n  role: 'dialog',\r\n}\r\n\r\n/**\r\n * Merge user config with defaults\r\n */\r\nexport function mergeConfig(config?: ModalConfig): ModalConfig {\r\n  if (!config) return { ...DEFAULT_CONFIG }\r\n\r\n  return {\r\n    ...DEFAULT_CONFIG,\r\n    ...config,\r\n  }\r\n}\r\n\r\n/**\r\n * Get a resolved config value\r\n */\r\nexport function getConfigValue<K extends keyof ModalConfig>(\r\n  config: ModalConfig,\r\n  key: K,\r\n  defaultValue: NonNullable<ModalConfig[K]>\r\n): NonNullable<ModalConfig[K]> {\r\n  const value = config[key]\r\n  return value !== undefined ? (value as NonNullable<ModalConfig[K]>) : defaultValue\r\n}\r\n","/**\r\n * Event emitter utilities for ModalKit\r\n */\r\n\r\nimport type { EventEmitter } from '../types'\r\n\r\n/**\r\n * Create a typed event emitter\r\n */\r\nexport function createEventEmitter<\r\n  T extends Record<string, unknown[]>\r\n>(): EventEmitter<T> {\r\n  const listeners = new Map<keyof T, Set<Function>>()\r\n\r\n  function on<K extends keyof T>(\r\n    event: K,\r\n    handler: (...args: T[K]) => void\r\n  ): () => void {\r\n    if (!listeners.has(event)) {\r\n      listeners.set(event, new Set())\r\n    }\r\n    listeners.get(event)!.add(handler)\r\n\r\n    // Return unsubscribe function\r\n    return () => off(event, handler)\r\n  }\r\n\r\n  function off<K extends keyof T>(\r\n    event: K,\r\n    handler: (...args: T[K]) => void\r\n  ): void {\r\n    const handlers = listeners.get(event)\r\n    if (handlers) {\r\n      handlers.delete(handler)\r\n      if (handlers.size === 0) {\r\n        listeners.delete(event)\r\n      }\r\n    }\r\n  }\r\n\r\n  function emit<K extends keyof T>(event: K, ...args: T[K]): void {\r\n    const handlers = listeners.get(event)\r\n    if (handlers) {\r\n      handlers.forEach((handler) => {\r\n        try {\r\n          handler(...args)\r\n        } catch (error) {\r\n          console.error(`Error in event handler for \"${String(event)}\":`, error)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  function clear(): void {\r\n    listeners.clear()\r\n  }\r\n\r\n  return { on, off, emit, clear }\r\n}\r\n\r\n/**\r\n * Create a simple subscription manager for state changes\r\n */\r\nexport function createSubscriptionManager<T>(): {\r\n  subscribe: (callback: (value: T) => void) => () => void\r\n  notify: (value: T) => void\r\n  clear: () => void\r\n} {\r\n  const subscribers = new Set<(value: T) => void>()\r\n\r\n  function subscribe(callback: (value: T) => void): () => void {\r\n    subscribers.add(callback)\r\n    return () => {\r\n      subscribers.delete(callback)\r\n    }\r\n  }\r\n\r\n  function notify(value: T): void {\r\n    subscribers.forEach((callback) => {\r\n      try {\r\n        callback(value)\r\n      } catch (error) {\r\n        console.error('Error in subscriber:', error)\r\n      }\r\n    })\r\n  }\r\n\r\n  function clear(): void {\r\n    subscribers.clear()\r\n  }\r\n\r\n  return { subscribe, notify, clear }\r\n}\r\n","/**\r\n * State management for ModalKit\r\n */\r\n\r\nimport type { ModalState, AnimationState, StateManager } from '../types'\r\nimport { createSubscriptionManager } from '../utils/events'\r\n\r\n/**\r\n * Create initial modal state\r\n */\r\nexport function createInitialState(defaultOpen: boolean = false): ModalState {\r\n  return {\r\n    open: defaultOpen,\r\n    animationState: defaultOpen ? 'entered' : 'idle',\r\n    stackOrder: 0,\r\n    isTopMost: false,\r\n    mounted: defaultOpen,\r\n  }\r\n}\r\n\r\n/**\r\n * Create a state manager\r\n */\r\nexport function createStateManager(\r\n  initialState: ModalState\r\n): StateManager<ModalState> {\r\n  let state = { ...initialState }\r\n  const { subscribe, notify } = createSubscriptionManager<ModalState>()\r\n\r\n  function getState(): ModalState {\r\n    return { ...state }\r\n  }\r\n\r\n  function setState(partial: Partial<ModalState>): void {\r\n    const prevState = state\r\n    state = { ...state, ...partial }\r\n\r\n    // Only notify if state actually changed\r\n    if (hasStateChanged(prevState, state)) {\r\n      notify(state)\r\n    }\r\n  }\r\n\r\n  return {\r\n    getState,\r\n    setState,\r\n    subscribe,\r\n  }\r\n}\r\n\r\n/**\r\n * Check if state has changed\r\n */\r\nfunction hasStateChanged(prev: ModalState, next: ModalState): boolean {\r\n  return (\r\n    prev.open !== next.open ||\r\n    prev.animationState !== next.animationState ||\r\n    prev.stackOrder !== next.stackOrder ||\r\n    prev.isTopMost !== next.isTopMost ||\r\n    prev.mounted !== next.mounted\r\n  )\r\n}\r\n\r\n/**\r\n * Derive mounted state from open and animation state\r\n */\r\nexport function shouldBeMounted(\r\n  open: boolean,\r\n  animationState: AnimationState\r\n): boolean {\r\n  // Mounted when open or during exit animation\r\n  return open || animationState === 'exiting' || animationState === 'exited'\r\n}\r\n\r\n/**\r\n * Get the next animation state based on current state and action\r\n */\r\nexport function getNextAnimationState(\r\n  currentState: AnimationState,\r\n  action: 'open' | 'close',\r\n  animated: boolean\r\n): AnimationState {\r\n  if (!animated) {\r\n    return action === 'open' ? 'entered' : 'idle'\r\n  }\r\n\r\n  if (action === 'open') {\r\n    return 'entering'\r\n  }\r\n\r\n  // Close action\r\n  if (currentState === 'entered' || currentState === 'entering') {\r\n    return 'exiting'\r\n  }\r\n\r\n  return 'idle'\r\n}\r\n","/**\r\n * Modal stack management for ModalKit\r\n */\r\n\r\nimport type { Modal, ModalStack, ModalInternal, StackEvent } from '../types'\r\nimport { createEventEmitter } from '../utils/events'\r\n\r\n/**\r\n * Stack event types\r\n */\r\ninterface StackEvents extends Record<string, unknown[]> {\r\n  push: [Modal]\r\n  pop: [Modal]\r\n  change: [Modal[]]\r\n}\r\n\r\n/**\r\n * Base z-index for modals\r\n */\r\nexport const BASE_Z_INDEX = 1000\r\n\r\n/**\r\n * Z-index increment per stacked modal\r\n */\r\nexport const Z_INDEX_INCREMENT = 10\r\n\r\n/**\r\n * Calculate z-index for a modal at given stack position\r\n */\r\nexport function calculateZIndex(stackOrder: number): number {\r\n  return BASE_Z_INDEX + (stackOrder - 1) * Z_INDEX_INCREMENT\r\n}\r\n\r\n/**\r\n * Create the modal stack manager\r\n */\r\nfunction createModalStack(): ModalStack & {\r\n  push: (modal: ModalInternal) => void\r\n  remove: (modal: ModalInternal) => void\r\n} {\r\n  const stack: ModalInternal[] = []\r\n  const events = createEventEmitter<StackEvents>()\r\n\r\n  function updateStackState(): void {\r\n    stack.forEach((modal, index) => {\r\n      const order = index + 1\r\n      const isTopMost = index === stack.length - 1\r\n      modal._setStackOrder(order)\r\n      modal._setIsTopMost(isTopMost)\r\n    })\r\n  }\r\n\r\n  function push(modal: ModalInternal): void {\r\n    // Check if modal is already in stack\r\n    const existingIndex = stack.indexOf(modal)\r\n    if (existingIndex !== -1) {\r\n      return\r\n    }\r\n\r\n    stack.push(modal)\r\n    updateStackState()\r\n    events.emit('push', modal)\r\n    events.emit('change', [...stack])\r\n  }\r\n\r\n  function remove(modal: ModalInternal): void {\r\n    const index = stack.indexOf(modal)\r\n    if (index === -1) return\r\n\r\n    stack.splice(index, 1)\r\n    updateStackState()\r\n    events.emit('pop', modal)\r\n    events.emit('change', [...stack])\r\n  }\r\n\r\n  function count(): number {\r\n    return stack.length\r\n  }\r\n\r\n  function isEmpty(): boolean {\r\n    return stack.length === 0\r\n  }\r\n\r\n  function getAll(): Modal[] {\r\n    return [...stack]\r\n  }\r\n\r\n  function getTopMost(): Modal | null {\r\n    return stack[stack.length - 1] ?? null\r\n  }\r\n\r\n  function getByOrder(order: number): Modal | null {\r\n    return stack[order - 1] ?? null\r\n  }\r\n\r\n  function closeAll(): void {\r\n    // Close from top to bottom\r\n    const modalsToClose = [...stack].reverse()\r\n    modalsToClose.forEach((modal) => modal.close())\r\n  }\r\n\r\n  function closeTopMost(): void {\r\n    const topMost = getTopMost()\r\n    if (topMost) {\r\n      topMost.close()\r\n    }\r\n  }\r\n\r\n  function on<K extends StackEvent>(\r\n    event: K,\r\n    handler: K extends 'change'\r\n      ? (modals: Modal[]) => void\r\n      : (modal: Modal) => void\r\n  ): () => void {\r\n    return events.on(event, handler as (...args: StackEvents[K]) => void)\r\n  }\r\n\r\n  function off<K extends StackEvent>(\r\n    event: K,\r\n    handler: K extends 'change'\r\n      ? (modals: Modal[]) => void\r\n      : (modal: Modal) => void\r\n  ): void {\r\n    events.off(event, handler as (...args: StackEvents[K]) => void)\r\n  }\r\n\r\n  return {\r\n    count,\r\n    isEmpty,\r\n    getAll,\r\n    getTopMost,\r\n    getByOrder,\r\n    closeAll,\r\n    closeTopMost,\r\n    on,\r\n    off,\r\n    push,\r\n    remove,\r\n  }\r\n}\r\n\r\n/**\r\n * Global modal stack singleton\r\n */\r\nexport const modalStack = createModalStack()\r\n\r\n/**\r\n * Internal stack methods for modal instances\r\n * @internal\r\n */\r\nexport const stackInternal = {\r\n  push: modalStack.push,\r\n  remove: modalStack.remove,\r\n}\r\n","/**\r\n * Focus utility functions for ModalKit\r\n */\r\n\r\n/**\r\n * Selector for focusable elements\r\n */\r\nexport const FOCUSABLE_SELECTOR = [\r\n  'a[href]',\r\n  'area[href]',\r\n  'button:not([disabled])',\r\n  'input:not([disabled])',\r\n  'select:not([disabled])',\r\n  'textarea:not([disabled])',\r\n  '[tabindex]:not([tabindex=\"-1\"])',\r\n  '[contenteditable=\"true\"]',\r\n  'audio[controls]',\r\n  'video[controls]',\r\n  'details > summary:first-of-type',\r\n].join(',')\r\n\r\n/**\r\n * Check if an element is visible\r\n */\r\nfunction isVisible(element: HTMLElement): boolean {\r\n  // Check if element is hidden\r\n  if (\r\n    element.offsetWidth === 0 &&\r\n    element.offsetHeight === 0 &&\r\n    element.getClientRects().length === 0\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Check computed styles\r\n  const style = getComputedStyle(element)\r\n  if (style.visibility === 'hidden' || style.display === 'none') {\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * Check if an element is focusable\r\n */\r\nexport function isFocusable(element: Element): boolean {\r\n  if (!(element instanceof HTMLElement)) return false\r\n  if (!element.matches(FOCUSABLE_SELECTOR)) return false\r\n  if (!isVisible(element)) return false\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * Get all focusable elements within a container\r\n */\r\nexport function getFocusableElements(container: HTMLElement): HTMLElement[] {\r\n  const elements = container.querySelectorAll<HTMLElement>(FOCUSABLE_SELECTOR)\r\n  return Array.from(elements).filter(isFocusable)\r\n}\r\n\r\n/**\r\n * Get the first focusable element in a container\r\n */\r\nexport function getFirstFocusable(container: HTMLElement): HTMLElement | null {\r\n  const focusables = getFocusableElements(container)\r\n  return focusables[0] ?? null\r\n}\r\n\r\n/**\r\n * Get the last focusable element in a container\r\n */\r\nexport function getLastFocusable(container: HTMLElement): HTMLElement | null {\r\n  const focusables = getFocusableElements(container)\r\n  return focusables[focusables.length - 1] ?? null\r\n}\r\n\r\n/**\r\n * Get the currently focused element\r\n */\r\nexport function getActiveElement(doc: Document = document): Element | null {\r\n  let activeElement = doc.activeElement\r\n\r\n  // Handle shadow DOM\r\n  while (activeElement?.shadowRoot?.activeElement) {\r\n    activeElement = activeElement.shadowRoot.activeElement\r\n  }\r\n\r\n  return activeElement\r\n}\r\n\r\n/**\r\n * Focus an element safely\r\n */\r\nexport function focusElement(\r\n  element: HTMLElement | null | undefined,\r\n  options?: FocusOptions\r\n): boolean {\r\n  if (!element) return false\r\n\r\n  try {\r\n    element.focus(options)\r\n    return getActiveElement() === element\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Storage for saved focus state\r\n */\r\ninterface FocusState {\r\n  element: HTMLElement | null\r\n  scrollX: number\r\n  scrollY: number\r\n}\r\n\r\nlet savedFocus: FocusState | null = null\r\n\r\n/**\r\n * Save the current focus state\r\n */\r\nexport function saveFocus(): void {\r\n  const activeElement = getActiveElement()\r\n  savedFocus = {\r\n    element: activeElement instanceof HTMLElement ? activeElement : null,\r\n    scrollX: window.scrollX,\r\n    scrollY: window.scrollY,\r\n  }\r\n}\r\n\r\n/**\r\n * Restore previously saved focus state\r\n */\r\nexport function restoreFocus(preventScroll: boolean = true): void {\r\n  if (!savedFocus) return\r\n\r\n  const { element, scrollX, scrollY } = savedFocus\r\n\r\n  if (element && document.body.contains(element)) {\r\n    focusElement(element, { preventScroll })\r\n\r\n    // Restore scroll position if needed\r\n    if (preventScroll) {\r\n      window.scrollTo(scrollX, scrollY)\r\n    }\r\n  }\r\n\r\n  savedFocus = null\r\n}\r\n\r\n/**\r\n * Clear saved focus without restoring\r\n */\r\nexport function clearSavedFocus(): void {\r\n  savedFocus = null\r\n}\r\n\r\n/**\r\n * Check if focus is within a container\r\n */\r\nexport function isFocusWithin(container: HTMLElement): boolean {\r\n  const activeElement = getActiveElement()\r\n  if (!activeElement) return false\r\n  return container.contains(activeElement)\r\n}\r\n","/**\r\n * Focus trap implementation for ModalKit\r\n */\r\n\r\nimport type { FocusTrap, FocusTrapConfig } from '../types'\r\nimport {\r\n  getFocusableElements,\r\n  getFirstFocusable,\r\n  focusElement,\r\n  getActiveElement,\r\n  saveFocus,\r\n  restoreFocus,\r\n} from '../utils/focus'\r\n\r\n/**\r\n * Create a focus trap instance\r\n */\r\nexport function createFocusTrap(config: FocusTrapConfig): FocusTrap {\r\n  const {\r\n    container,\r\n    initialFocus,\r\n    fallbackFocus,\r\n    returnFocus,\r\n    escapeDeactivates = true,\r\n    clickOutsideDeactivates = false,\r\n    allowOutsideClick = false,\r\n    onActivate,\r\n    onDeactivate,\r\n  } = config\r\n\r\n  let active = false\r\n  let paused = false\r\n  let focusing = false // Guard against re-entrancy in handleFocusIn\r\n\r\n  // Resolve element from ref\r\n  function resolveElement(\r\n    ref: HTMLElement | (() => HTMLElement | null) | null | undefined\r\n  ): HTMLElement | null {\r\n    if (!ref) return null\r\n    if (typeof ref === 'function') return ref()\r\n    return ref\r\n  }\r\n\r\n  // Handle Tab key navigation\r\n  function handleKeyDown(event: KeyboardEvent): void {\r\n    if (!active || paused) return\r\n    if (event.key !== 'Tab') return\r\n\r\n    const focusables = getFocusableElements(container)\r\n    if (focusables.length === 0) return\r\n\r\n    const firstFocusable = focusables[0]\r\n    const lastFocusable = focusables[focusables.length - 1]\r\n    const activeElement = getActiveElement()\r\n\r\n    // Handle Shift+Tab (backwards)\r\n    if (event.shiftKey) {\r\n      if (activeElement === firstFocusable || !container.contains(activeElement as Node)) {\r\n        event.preventDefault()\r\n        focusElement(lastFocusable)\r\n      }\r\n    } else {\r\n      // Handle Tab (forwards)\r\n      if (activeElement === lastFocusable || !container.contains(activeElement as Node)) {\r\n        event.preventDefault()\r\n        focusElement(firstFocusable)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Handle Escape key\r\n  function handleEscapeKey(event: KeyboardEvent): void {\r\n    if (!active || paused) return\r\n    if (event.key !== 'Escape') return\r\n\r\n    if (escapeDeactivates) {\r\n      event.preventDefault()\r\n      deactivate()\r\n    }\r\n  }\r\n\r\n  // Handle clicks outside the container\r\n  function handleClick(event: MouseEvent): void {\r\n    if (!active || paused) return\r\n\r\n    const target = event.target as Node\r\n    if (!container.contains(target)) {\r\n      // Check if outside click is allowed\r\n      const shouldAllowClick =\r\n        typeof allowOutsideClick === 'function'\r\n          ? allowOutsideClick(event)\r\n          : allowOutsideClick\r\n\r\n      if (!shouldAllowClick) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n      }\r\n\r\n      if (clickOutsideDeactivates) {\r\n        deactivate()\r\n      }\r\n    }\r\n  }\r\n\r\n  // Handle focus leaving the container\r\n  function handleFocusIn(event: FocusEvent): void {\r\n    if (!active || paused || focusing) return\r\n\r\n    const target = event.target as Node\r\n    if (!container.contains(target)) {\r\n      // Focus has left the trap, bring it back\r\n      focusing = true\r\n      event.preventDefault()\r\n      const firstFocusable = getFirstFocusable(container)\r\n      if (firstFocusable) {\r\n        focusElement(firstFocusable)\r\n      } else {\r\n        // Fallback to container itself\r\n        container.focus()\r\n      }\r\n      // Use setTimeout to reset the guard after focus event completes\r\n      setTimeout(() => { focusing = false }, 0)\r\n    }\r\n  }\r\n\r\n  function activate(): void {\r\n    if (active) return\r\n\r\n    // Save current focus for restoration\r\n    saveFocus()\r\n\r\n    active = true\r\n    paused = false\r\n\r\n    // Add event listeners\r\n    document.addEventListener('keydown', handleKeyDown, true)\r\n    document.addEventListener('keydown', handleEscapeKey, true)\r\n    document.addEventListener('click', handleClick, true)\r\n    document.addEventListener('focusin', handleFocusIn, true)\r\n\r\n    // Set initial focus\r\n    const initialElement = resolveElement(initialFocus)\r\n    const fallbackElement = resolveElement(fallbackFocus)\r\n    const firstFocusable = getFirstFocusable(container)\r\n\r\n    const elementToFocus =\r\n      initialElement ??\r\n      fallbackElement ??\r\n      firstFocusable ??\r\n      container\r\n\r\n    // Make container focusable as fallback\r\n    if (!container.hasAttribute('tabindex')) {\r\n      container.setAttribute('tabindex', '-1')\r\n    }\r\n\r\n    focusElement(elementToFocus as HTMLElement, { preventScroll: true })\r\n\r\n    onActivate?.()\r\n  }\r\n\r\n  function deactivate(): void {\r\n    if (!active) return\r\n\r\n    active = false\r\n    paused = false\r\n\r\n    // Remove event listeners\r\n    document.removeEventListener('keydown', handleKeyDown, true)\r\n    document.removeEventListener('keydown', handleEscapeKey, true)\r\n    document.removeEventListener('click', handleClick, true)\r\n    document.removeEventListener('focusin', handleFocusIn, true)\r\n\r\n    // Restore focus\r\n    const returnElement = resolveElement(returnFocus)\r\n    if (returnElement) {\r\n      focusElement(returnElement, { preventScroll: true })\r\n    } else {\r\n      restoreFocus(true)\r\n    }\r\n\r\n    onDeactivate?.()\r\n  }\r\n\r\n  function pause(): void {\r\n    if (!active) return\r\n    paused = true\r\n  }\r\n\r\n  function unpause(): void {\r\n    if (!active) return\r\n    paused = false\r\n  }\r\n\r\n  function isActive(): boolean {\r\n    return active\r\n  }\r\n\r\n  function isPaused(): boolean {\r\n    return paused\r\n  }\r\n\r\n  return {\r\n    activate,\r\n    deactivate,\r\n    pause,\r\n    unpause,\r\n    isActive,\r\n    isPaused,\r\n  }\r\n}\r\n","/**\r\n * DOM utility functions for ModalKit\r\n */\r\n\r\n/**\r\n * Get an element by selector string or return the element itself\r\n */\r\nexport function getElement(\r\n  target: HTMLElement | string | null | undefined\r\n): HTMLElement | null {\r\n  if (!target) return null\r\n  if (typeof target === 'string') {\r\n    return document.querySelector(target)\r\n  }\r\n  return target\r\n}\r\n\r\n/**\r\n * Create a portal container element\r\n */\r\nexport function createPortalContainer(id?: string): HTMLDivElement {\r\n  const container = document.createElement('div')\r\n  if (id) {\r\n    container.id = id\r\n  }\r\n  container.setAttribute('data-modalkit-portal', '')\r\n  return container\r\n}\r\n\r\n/**\r\n * Safely remove an element from the DOM\r\n */\r\nexport function removeElement(element: HTMLElement | null): void {\r\n  if (element && element.parentNode) {\r\n    element.parentNode.removeChild(element)\r\n  }\r\n}\r\n\r\n/**\r\n * Check if an element is in the document\r\n */\r\nexport function isInDocument(element: HTMLElement | null): boolean {\r\n  if (!element) return false\r\n  return document.body.contains(element)\r\n}\r\n\r\n/**\r\n * Get the document's scrollbar width\r\n */\r\nexport function getScrollbarWidth(): number {\r\n  // Create outer element\r\n  const outer = document.createElement('div')\r\n  outer.style.visibility = 'hidden'\r\n  outer.style.overflow = 'scroll'\r\n  document.body.appendChild(outer)\r\n\r\n  // Create inner element\r\n  const inner = document.createElement('div')\r\n  outer.appendChild(inner)\r\n\r\n  // Calculate scrollbar width\r\n  const scrollbarWidth = outer.offsetWidth - inner.offsetWidth\r\n\r\n  // Cleanup\r\n  removeElement(outer)\r\n\r\n  return scrollbarWidth\r\n}\r\n\r\n/**\r\n * Check if the element or its descendants contain another element\r\n */\r\nexport function contains(parent: Element | null, child: Element | null): boolean {\r\n  if (!parent || !child) return false\r\n  return parent === child || parent.contains(child)\r\n}\r\n\r\n/**\r\n * Set multiple styles on an element\r\n */\r\nexport function setStyles(\r\n  element: HTMLElement,\r\n  styles: Partial<CSSStyleDeclaration>\r\n): void {\r\n  Object.assign(element.style, styles)\r\n}\r\n\r\n/**\r\n * Get the owner document of an element\r\n */\r\nexport function getOwnerDocument(element: Element | null): Document {\r\n  return element?.ownerDocument ?? document\r\n}\r\n\r\n/**\r\n * Check if we're in a browser environment\r\n */\r\nexport function isBrowser(): boolean {\r\n  return typeof window !== 'undefined' && typeof document !== 'undefined'\r\n}\r\n","/**\r\n * Scroll lock implementation for ModalKit\r\n */\r\n\r\nimport type { ScrollLock } from '../types'\r\nimport { getScrollbarWidth } from '../utils/dom'\r\n\r\n// Reference counting for multiple modals\r\nlet lockCount = 0\r\n\r\n// Store original body styles\r\nlet originalStyles: {\r\n  overflow: string\r\n  paddingRight: string\r\n} | null = null\r\n\r\n/**\r\n * Check if iOS Safari\r\n * @internal\r\n */\r\n/* c8 ignore start */\r\nfunction isIOS(): boolean {\r\n  return (\r\n    typeof navigator !== 'undefined' &&\r\n    /iPad|iPhone|iPod/.test(navigator.userAgent)\r\n  )\r\n}\r\n\r\n/**\r\n * Get current scroll position\r\n * @internal\r\n */\r\nfunction getScrollPosition(): { x: number; y: number } {\r\n  return {\r\n    x: window.pageXOffset ?? document.documentElement.scrollLeft,\r\n    y: window.pageYOffset ?? document.documentElement.scrollTop,\r\n  }\r\n}\r\n/* c8 ignore stop */\r\n\r\n// Store scroll position for iOS fix\r\nlet scrollPosition: { x: number; y: number } | null = null\r\n\r\n/**\r\n * Lock body scroll\r\n */\r\nfunction lock(): void {\r\n  lockCount++\r\n\r\n  // Only apply lock on first call\r\n  if (lockCount > 1) return\r\n\r\n  const scrollbarWidth = getScrollbarWidth()\r\n  const hasScrollbar = window.innerWidth > document.documentElement.clientWidth\r\n\r\n  // Save original styles\r\n  originalStyles = {\r\n    overflow: document.body.style.overflow,\r\n    paddingRight: document.body.style.paddingRight,\r\n  }\r\n\r\n  // Apply lock styles\r\n  document.body.style.overflow = 'hidden'\r\n\r\n  // Add padding to prevent layout shift from scrollbar disappearing\r\n  if (hasScrollbar && scrollbarWidth > 0) {\r\n    const currentPadding = parseInt(\r\n      getComputedStyle(document.body).paddingRight,\r\n      10\r\n    ) || 0\r\n    document.body.style.paddingRight = `${currentPadding + scrollbarWidth}px`\r\n  }\r\n\r\n  // iOS Safari fix\r\n  /* c8 ignore start */\r\n  if (isIOS()) {\r\n    scrollPosition = getScrollPosition()\r\n    document.body.style.position = 'fixed'\r\n    document.body.style.top = `-${scrollPosition.y}px`\r\n    document.body.style.left = `-${scrollPosition.x}px`\r\n    document.body.style.width = '100%'\r\n  }\r\n  /* c8 ignore stop */\r\n}\r\n\r\n/**\r\n * Unlock body scroll\r\n */\r\n/* c8 ignore start */\r\nfunction unlock(): void {\r\n  if (lockCount === 0) return\r\n\r\n  lockCount--\r\n\r\n  // Only remove lock on last call\r\n  if (lockCount > 0) return\r\n\r\n  // Restore original styles\r\n  if (originalStyles) {\r\n    document.body.style.overflow = originalStyles.overflow\r\n    document.body.style.paddingRight = originalStyles.paddingRight\r\n    originalStyles = null\r\n  }\r\n\r\n  // iOS Safari fix - restore scroll position\r\n  if (isIOS() && scrollPosition) {\r\n    document.body.style.position = ''\r\n    document.body.style.top = ''\r\n    document.body.style.left = ''\r\n    document.body.style.width = ''\r\n    window.scrollTo(scrollPosition.x, scrollPosition.y)\r\n    scrollPosition = null\r\n  }\r\n}\r\n/* c8 ignore stop */\r\n\r\n/**\r\n * Check if scroll is locked\r\n */\r\nfunction isLocked(): boolean {\r\n  return lockCount > 0\r\n}\r\n\r\n/**\r\n * Force reset scroll lock (useful for testing)\r\n * @internal\r\n */\r\nexport function resetScrollLock(): void {\r\n  if (originalStyles) {\r\n    document.body.style.overflow = originalStyles.overflow\r\n    document.body.style.paddingRight = originalStyles.paddingRight\r\n    originalStyles = null\r\n  }\r\n\r\n  /* c8 ignore start */\r\n  if (isIOS()) {\r\n    document.body.style.position = ''\r\n    document.body.style.top = ''\r\n    document.body.style.left = ''\r\n    document.body.style.width = ''\r\n  }\r\n  /* c8 ignore stop */\r\n\r\n  lockCount = 0\r\n  scrollPosition = null\r\n}\r\n\r\n/**\r\n * Scroll lock singleton\r\n */\r\nexport const scrollLock: ScrollLock = {\r\n  lock,\r\n  unlock,\r\n  isLocked,\r\n}\r\n","/**\r\n * Animation controller for ModalKit\r\n */\r\n\r\nimport type { AnimationState, AnimationType, AnimationController } from '../types'\r\n\r\n/**\r\n * Configuration for animation controller\r\n */\r\nexport interface AnimationControllerConfig {\r\n  /** Animation duration in ms */\r\n  duration: number\r\n  /** Called when animation state changes */\r\n  onStateChange?: (state: AnimationState) => void\r\n  /** Called when animation starts */\r\n  onAnimationStart?: (type: AnimationType) => void\r\n  /** Called when animation ends */\r\n  onAnimationEnd?: (type: AnimationType) => void\r\n}\r\n\r\n/**\r\n * Create an animation controller\r\n */\r\nexport function createAnimationController(\r\n  config: AnimationControllerConfig\r\n): AnimationController {\r\n  const { duration, onStateChange, onAnimationStart, onAnimationEnd } = config\r\n\r\n  let state: AnimationState = 'idle'\r\n  let timerId: ReturnType<typeof setTimeout> | null = null\r\n\r\n  function clearTimer(): void {\r\n    if (timerId !== null) {\r\n      clearTimeout(timerId)\r\n      timerId = null\r\n    }\r\n  }\r\n\r\n  function setState(newState: AnimationState): void {\r\n    if (state !== newState) {\r\n      state = newState\r\n      onStateChange?.(state)\r\n    }\r\n  }\r\n\r\n  function startEnter(): void {\r\n    clearTimer()\r\n    setState('entering')\r\n    onAnimationStart?.('enter')\r\n\r\n    timerId = setTimeout(() => {\r\n      setState('entered')\r\n      onAnimationEnd?.('enter')\r\n      timerId = null\r\n    }, duration)\r\n  }\r\n\r\n  function startExit(): void {\r\n    clearTimer()\r\n    setState('exiting')\r\n    onAnimationStart?.('exit')\r\n\r\n    timerId = setTimeout(() => {\r\n      setState('exited')\r\n      onAnimationEnd?.('exit')\r\n\r\n      // Transition to idle after exited\r\n      timerId = setTimeout(() => {\r\n        setState('idle')\r\n        timerId = null\r\n      }, 0)\r\n    }, duration)\r\n  }\r\n\r\n  function skipTo(targetState: 'entered' | 'exited'): void {\r\n    clearTimer()\r\n\r\n    if (targetState === 'entered') {\r\n      setState('entered')\r\n    } else {\r\n      setState('exited')\r\n      // Transition to idle\r\n      timerId = setTimeout(() => {\r\n        setState('idle')\r\n        timerId = null\r\n      }, 0)\r\n    }\r\n  }\r\n\r\n  function getState(): AnimationState {\r\n    return state\r\n  }\r\n\r\n  function isAnimating(): boolean {\r\n    return state === 'entering' || state === 'exiting'\r\n  }\r\n\r\n  function destroy(): void {\r\n    clearTimer()\r\n    state = 'idle'\r\n  }\r\n\r\n  return {\r\n    startEnter,\r\n    startExit,\r\n    skipTo,\r\n    getState,\r\n    isAnimating,\r\n    destroy,\r\n  }\r\n}\r\n\r\n/**\r\n * Create a no-op animation controller (for when animations are disabled)\r\n */\r\nexport function createNoopAnimationController(): AnimationController {\r\n  let state: AnimationState = 'idle'\r\n\r\n  return {\r\n    startEnter() {\r\n      state = 'entered'\r\n    },\r\n    startExit() {\r\n      state = 'idle'\r\n    },\r\n    skipTo(targetState: 'entered' | 'exited') {\r\n      state = targetState === 'entered' ? 'entered' : 'idle'\r\n    },\r\n    getState() {\r\n      return state\r\n    },\r\n    isAnimating() {\r\n      return false\r\n    },\r\n    destroy() {\r\n      state = 'idle'\r\n    },\r\n  }\r\n}\r\n","/**\r\n * Keyboard handling for ModalKit\r\n */\r\n\r\n/**\r\n * Check if event is Escape key\r\n */\r\nexport function isEscapeKey(event: KeyboardEvent): boolean {\r\n  return event.key === 'Escape' || event.key === 'Esc' || event.keyCode === 27\r\n}\r\n\r\n/**\r\n * Check if event is Tab key\r\n */\r\nexport function isTabKey(event: KeyboardEvent): boolean {\r\n  return event.key === 'Tab' || event.keyCode === 9\r\n}\r\n\r\n/**\r\n * Check if event is Enter key\r\n */\r\nexport function isEnterKey(event: KeyboardEvent): boolean {\r\n  return event.key === 'Enter' || event.keyCode === 13\r\n}\r\n\r\n/**\r\n * Check if event is Space key\r\n */\r\nexport function isSpaceKey(event: KeyboardEvent): boolean {\r\n  return event.key === ' ' || event.key === 'Spacebar' || event.keyCode === 32\r\n}\r\n\r\n/**\r\n * Configuration for keyboard handler\r\n */\r\nexport interface KeyboardHandlerConfig {\r\n  /** Close modal on Escape */\r\n  closeOnEscape: boolean\r\n  /** Callback when Escape is pressed */\r\n  onEscapeKeyDown?: (event: KeyboardEvent) => void\r\n  /** Close callback */\r\n  onClose: () => void\r\n  /** Whether this is the top-most modal */\r\n  isTopMost: () => boolean\r\n}\r\n\r\n/**\r\n * Create a keyboard event handler for modals\r\n */\r\nexport function createKeyboardHandler(\r\n  config: KeyboardHandlerConfig\r\n): (event: KeyboardEvent) => void {\r\n  const { closeOnEscape, onEscapeKeyDown, onClose, isTopMost } = config\r\n\r\n  return function handleKeyDown(event: KeyboardEvent): void {\r\n    // Only handle events for top-most modal\r\n    if (!isTopMost()) return\r\n\r\n    if (isEscapeKey(event)) {\r\n      // Call user callback first\r\n      onEscapeKeyDown?.(event)\r\n\r\n      // Close if enabled and event not prevented\r\n      if (closeOnEscape && !event.defaultPrevented) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        onClose()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Prevent default and stop propagation\r\n */\r\nexport function stopEvent(event: Event): void {\r\n  event.preventDefault()\r\n  event.stopPropagation()\r\n}\r\n","/**\r\n * Portal utilities for ModalKit\r\n */\r\n\r\nimport { getElement, createPortalContainer, removeElement } from '../utils/dom'\r\n\r\n// Default portal container ID\r\nconst DEFAULT_PORTAL_ID = 'modalkit-portal-root'\r\n\r\n/**\r\n * Get or create the default portal container\r\n */\r\nexport function getPortalContainer(\r\n  target?: HTMLElement | string | null\r\n): HTMLElement {\r\n  // If a specific target is provided, use it\r\n  if (target) {\r\n    const element = getElement(target)\r\n    if (element) return element\r\n  }\r\n\r\n  // Try to find existing default container\r\n  let container = document.getElementById(DEFAULT_PORTAL_ID)\r\n\r\n  // Create new container if doesn't exist\r\n  if (!container) {\r\n    container = createPortalContainer(DEFAULT_PORTAL_ID)\r\n    document.body.appendChild(container)\r\n  }\r\n\r\n  return container\r\n}\r\n\r\n/**\r\n * Create a new portal element\r\n */\r\nexport function createPortal(id?: string): HTMLDivElement {\r\n  return createPortalContainer(id)\r\n}\r\n\r\n/**\r\n * Append a portal element to a target\r\n */\r\nexport function appendPortal(\r\n  portal: HTMLElement,\r\n  target?: HTMLElement | string | null\r\n): void {\r\n  const container = getPortalContainer(target)\r\n  container.appendChild(portal)\r\n}\r\n\r\n/**\r\n * Remove a portal element from the DOM\r\n */\r\nexport function removePortal(portal: HTMLElement | null): void {\r\n  removeElement(portal)\r\n}\r\n\r\n/**\r\n * Clean up all modalkit portals from the DOM\r\n */\r\nexport function cleanupPortals(): void {\r\n  const portals = document.querySelectorAll('[data-modalkit-portal]')\r\n  portals.forEach((portal) => portal.remove())\r\n\r\n  // Also remove the default container if empty\r\n  const defaultContainer = document.getElementById(DEFAULT_PORTAL_ID)\r\n  if (defaultContainer && defaultContainer.children.length === 0) {\r\n    defaultContainer.remove()\r\n  }\r\n}\r\n","/**\r\n * ID generation utilities for ModalKit\r\n */\r\n\r\nlet counter = 0\r\n\r\n/**\r\n * Generate a unique ID with optional prefix\r\n */\r\nexport function generateId(prefix: string = 'modalkit'): string {\r\n  counter++\r\n  return `${prefix}-${counter}`\r\n}\r\n\r\n/**\r\n * Create a namespaced ID generator\r\n */\r\nexport function createIdGenerator(namespace: string): () => string {\r\n  let localCounter = 0\r\n\r\n  return function generateNamespacedId(): string {\r\n    localCounter++\r\n    return `${namespace}-${localCounter}`\r\n  }\r\n}\r\n\r\n/**\r\n * Reset the global counter (useful for testing)\r\n */\r\nexport function resetIdCounter(): void {\r\n  counter = 0\r\n}\r\n\r\n/**\r\n * Create modal-specific IDs\r\n */\r\nexport function createModalIds(baseId: string): {\r\n  modalId: string\r\n  titleId: string\r\n  descriptionId: string\r\n} {\r\n  return {\r\n    modalId: baseId,\r\n    titleId: `${baseId}-title`,\r\n    descriptionId: `${baseId}-description`,\r\n  }\r\n}\r\n","/**\r\n * Main modal factory for ModalKit\r\n */\r\n\r\nimport type {\r\n  Modal,\r\n  ModalConfig,\r\n  ModalState,\r\n  ModalInternal,\r\n  AnimationState,\r\n  PortalProps,\r\n  OverlayProps,\r\n  ContainerProps,\r\n  ContentProps,\r\n  TitleProps,\r\n  DescriptionProps,\r\n  CloseButtonProps,\r\n  TriggerProps,\r\n  FocusTrap,\r\n} from '../types'\r\n\r\nimport { mergeConfig, DEFAULT_CONFIG } from './config'\r\nimport { createInitialState, createStateManager, shouldBeMounted } from './state'\r\nimport { stackInternal, calculateZIndex } from './stack'\r\nimport { createFocusTrap } from '../features/focus-trap'\r\nimport { scrollLock } from '../features/scroll-lock'\r\nimport {\r\n  createAnimationController,\r\n  createNoopAnimationController,\r\n} from '../features/animation'\r\nimport { createKeyboardHandler } from '../features/keyboard'\r\nimport { getPortalContainer } from '../features/portal'\r\nimport { generateId, createModalIds } from '../utils/id'\r\nimport { contains as domContains } from '../utils/dom'\r\nimport {\r\n  saveFocus,\r\n  restoreFocus,\r\n  focusElement,\r\n  getFirstFocusable,\r\n  getLastFocusable,\r\n} from '../utils/focus'\r\n\r\n/**\r\n * Create a new modal instance\r\n */\r\nexport function createModal(userConfig?: ModalConfig): Modal {\r\n  // Merge config with defaults\r\n  const config = mergeConfig(userConfig)\r\n\r\n  // Generate IDs\r\n  const baseId = config.id ?? generateId('modal')\r\n  const ids = createModalIds(baseId)\r\n\r\n  // Initialize state\r\n  const initialOpen = config.open ?? config.defaultOpen ?? false\r\n  const stateManager = createStateManager(createInitialState(initialOpen))\r\n\r\n  // Animation controller\r\n  const animationController = config.animated\r\n    ? createAnimationController({\r\n        duration: config.animationDuration ?? DEFAULT_CONFIG.animationDuration,\r\n        onStateChange: (animationState) => {\r\n          stateManager.setState({\r\n            animationState,\r\n            mounted: shouldBeMounted(stateManager.getState().open, animationState),\r\n          })\r\n        },\r\n        onAnimationStart: config.onAnimationStart,\r\n        onAnimationEnd: config.onAnimationEnd,\r\n      })\r\n    : createNoopAnimationController()\r\n\r\n  // Focus trap (created lazily)\r\n  let focusTrap: FocusTrap | null = null\r\n  let contentElement: HTMLElement | null = null\r\n  let overlayElement: HTMLElement | null = null\r\n  let containerElement: HTMLElement | null = null\r\n\r\n  // Keyboard handler\r\n  const handleKeyDown = createKeyboardHandler({\r\n    closeOnEscape: config.closeOnEscape ?? DEFAULT_CONFIG.closeOnEscape,\r\n    onEscapeKeyDown: config.onEscapeKeyDown,\r\n    onClose: () => close(),\r\n    isTopMost: () => stateManager.getState().isTopMost,\r\n  })\r\n\r\n  // ============ INTERNAL METHODS ============\r\n\r\n  function resolveElement(\r\n    ref: HTMLElement | (() => HTMLElement | null) | null | undefined\r\n  ): HTMLElement | null {\r\n    if (!ref) return null\r\n    if (typeof ref === 'function') return ref()\r\n    return ref\r\n  }\r\n\r\n  function setupFocusTrap(): void {\r\n    if (!contentElement || focusTrap) return\r\n    if (!config.trapFocus) return\r\n\r\n    focusTrap = createFocusTrap({\r\n      container: contentElement,\r\n      initialFocus: resolveElement(config.initialFocusRef),\r\n      returnFocus: resolveElement(config.finalFocusRef),\r\n      escapeDeactivates: false, // We handle escape ourselves\r\n      clickOutsideDeactivates: false,\r\n    })\r\n  }\r\n\r\n  function teardownFocusTrap(): void {\r\n    if (focusTrap) {\r\n      focusTrap.deactivate()\r\n      focusTrap = null\r\n    }\r\n  }\r\n\r\n  function activateFocusTrap(): void {\r\n    // Create focus trap if needed\r\n    if (!focusTrap && config.trapFocus && contentElement) {\r\n      setupFocusTrap()\r\n    }\r\n\r\n    // Activate if exists and not active\r\n    if (focusTrap && !focusTrap.isActive()) {\r\n      focusTrap.activate()\r\n    }\r\n  }\r\n\r\n  function handleOpen(): void {\r\n    const state = stateManager.getState()\r\n    if (state.open) return\r\n\r\n    // Save focus before opening\r\n    if (config.restoreFocus) {\r\n      saveFocus()\r\n    }\r\n\r\n    // Update state\r\n    stateManager.setState({ open: true, mounted: true })\r\n\r\n    // Start animation\r\n    if (config.animated) {\r\n      animationController.startEnter()\r\n    } else {\r\n      stateManager.setState({ animationState: 'entered' })\r\n    }\r\n\r\n    // Add to stack\r\n    stackInternal.push(modal as ModalInternal)\r\n\r\n    // Lock scroll\r\n    if (config.preventScroll) {\r\n      scrollLock.lock()\r\n    }\r\n\r\n    // Callbacks\r\n    config.onOpen?.()\r\n    config.onOpenChange?.(true)\r\n\r\n    // Focus trap will be activated when content is mounted\r\n    // (via ref callback in getContentProps)\r\n  }\r\n\r\n  function handleClose(): void {\r\n    const state = stateManager.getState()\r\n    if (!state.open) return\r\n\r\n    // Update state\r\n    stateManager.setState({ open: false })\r\n\r\n    // Start animation\r\n    if (config.animated) {\r\n      animationController.startExit()\r\n    } else {\r\n      stateManager.setState({ animationState: 'idle', mounted: false })\r\n    }\r\n\r\n    // Remove from stack\r\n    stackInternal.remove(modal as ModalInternal)\r\n\r\n    // Deactivate focus trap\r\n    teardownFocusTrap()\r\n\r\n    // Unlock scroll\r\n    if (config.preventScroll) {\r\n      scrollLock.unlock()\r\n    }\r\n\r\n    // Restore focus\r\n    if (config.restoreFocus) {\r\n      const finalFocus = resolveElement(config.finalFocusRef)\r\n      if (finalFocus) {\r\n        focusElement(finalFocus)\r\n      } else {\r\n        restoreFocus()\r\n      }\r\n    }\r\n\r\n    // Callbacks\r\n    config.onClose?.()\r\n    config.onOpenChange?.(false)\r\n  }\r\n\r\n  function handleOverlayClick(e: MouseEvent): void {\r\n    // Only close if clicking directly on overlay/container, not content\r\n    const target = e.target as HTMLElement\r\n    const isOverlay = target === overlayElement || target === containerElement\r\n\r\n    if (!isOverlay) return\r\n\r\n    config.onOverlayClick?.(e)\r\n\r\n    if (config.closeOnOverlayClick && !e.defaultPrevented) {\r\n      close()\r\n    }\r\n  }\r\n\r\n  // ============ PUBLIC API ============\r\n\r\n  function isOpen(): boolean {\r\n    return stateManager.getState().open\r\n  }\r\n\r\n  function isMounted(): boolean {\r\n    return stateManager.getState().mounted\r\n  }\r\n\r\n  function getState(): ModalState {\r\n    return stateManager.getState()\r\n  }\r\n\r\n  function subscribe(callback: (state: ModalState) => void): () => void {\r\n    return stateManager.subscribe(callback)\r\n  }\r\n\r\n  function open(): void {\r\n    handleOpen()\r\n  }\r\n\r\n  function close(): void {\r\n    handleClose()\r\n  }\r\n\r\n  function toggle(): void {\r\n    if (isOpen()) {\r\n      close()\r\n    } else {\r\n      open()\r\n    }\r\n  }\r\n\r\n  function getStackOrder(): number {\r\n    return stateManager.getState().stackOrder\r\n  }\r\n\r\n  function isTopMost(): boolean {\r\n    return stateManager.getState().isTopMost\r\n  }\r\n\r\n  function isAnimating(): boolean {\r\n    return animationController.isAnimating()\r\n  }\r\n\r\n  function getAnimationState(): AnimationState {\r\n    return stateManager.getState().animationState\r\n  }\r\n\r\n  function focusFirst(): void {\r\n    if (!contentElement) return\r\n    const first = getFirstFocusable(contentElement)\r\n    if (first) focusElement(first)\r\n  }\r\n\r\n  function focusLast(): void {\r\n    if (!contentElement) return\r\n    const last = getLastFocusable(contentElement)\r\n    if (last) focusElement(last)\r\n  }\r\n\r\n  function contains(element: Element | null): boolean {\r\n    return domContains(contentElement, element)\r\n  }\r\n\r\n  function getPortalTarget(): HTMLElement {\r\n    return getPortalContainer(config.portalTarget)\r\n  }\r\n\r\n  // ============ PROPS GETTERS ============\r\n\r\n  function getPortalProps(): PortalProps {\r\n    return {\r\n      'data-modalkit-portal': '',\r\n      'data-state': getAnimationState(),\r\n    }\r\n  }\r\n\r\n  function getOverlayProps(): OverlayProps {\r\n    const state = getState()\r\n    const zIndex = calculateZIndex(state.stackOrder)\r\n\r\n    return {\r\n      ref: (el) => {\r\n        overlayElement = el\r\n      },\r\n      'data-modalkit-overlay': '',\r\n      'data-state': state.animationState,\r\n      style: {\r\n        position: 'fixed',\r\n        inset: '0',\r\n        zIndex,\r\n      },\r\n      onClick: handleOverlayClick,\r\n    }\r\n  }\r\n\r\n  function getContainerProps(): ContainerProps {\r\n    const state = getState()\r\n    const zIndex = calculateZIndex(state.stackOrder) + 1\r\n    const scrollBehavior = config.scrollBehavior ?? DEFAULT_CONFIG.scrollBehavior\r\n\r\n    return {\r\n      ref: (el) => {\r\n        containerElement = el\r\n      },\r\n      'data-modalkit-container': '',\r\n      'data-state': state.animationState,\r\n      style: {\r\n        position: 'fixed',\r\n        inset: '0',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex,\r\n        overflow: scrollBehavior === 'inside' ? 'auto' : 'hidden',\r\n      },\r\n      onClick: handleOverlayClick,\r\n    }\r\n  }\r\n\r\n  function getContentProps(): ContentProps {\r\n    const state = getState()\r\n\r\n    const props: ContentProps = {\r\n      ref: (el) => {\r\n        const wasNull = contentElement === null\r\n        contentElement = el\r\n\r\n        // Setup and activate focus trap when content is mounted\r\n        if (el && wasNull && state.open) {\r\n          setupFocusTrap()\r\n          if (config.autoFocus) {\r\n            // Delay to ensure element is in DOM\r\n            requestAnimationFrame(() => {\r\n              activateFocusTrap()\r\n            })\r\n          }\r\n        }\r\n      },\r\n      role: config.role ?? DEFAULT_CONFIG.role,\r\n      'aria-modal': true,\r\n      'data-modalkit-content': '',\r\n      'data-state': state.animationState,\r\n      tabIndex: -1,\r\n      onKeyDown: handleKeyDown,\r\n    }\r\n\r\n    // Add aria attributes\r\n    if (config.ariaLabel) {\r\n      props['aria-label'] = config.ariaLabel\r\n    } else if (config.ariaLabelledBy) {\r\n      props['aria-labelledby'] = config.ariaLabelledBy\r\n    } else {\r\n      // Default to title ID\r\n      props['aria-labelledby'] = ids.titleId\r\n    }\r\n\r\n    if (config.ariaDescribedBy) {\r\n      props['aria-describedby'] = config.ariaDescribedBy\r\n    } else {\r\n      props['aria-describedby'] = ids.descriptionId\r\n    }\r\n\r\n    return props\r\n  }\r\n\r\n  function getTitleProps(customId?: string): TitleProps {\r\n    return {\r\n      id: customId ?? ids.titleId,\r\n      'data-modalkit-title': '',\r\n    }\r\n  }\r\n\r\n  function getDescriptionProps(customId?: string): DescriptionProps {\r\n    return {\r\n      id: customId ?? ids.descriptionId,\r\n      'data-modalkit-description': '',\r\n    }\r\n  }\r\n\r\n  function getCloseButtonProps(): CloseButtonProps {\r\n    return {\r\n      type: 'button',\r\n      'aria-label': 'Close',\r\n      'data-modalkit-close': '',\r\n      onClick: () => close(),\r\n    }\r\n  }\r\n\r\n  function getTriggerProps(): TriggerProps {\r\n    return {\r\n      type: 'button',\r\n      'aria-haspopup': 'dialog',\r\n      'aria-expanded': isOpen(),\r\n      'data-modalkit-trigger': '',\r\n      onClick: () => open(),\r\n    }\r\n  }\r\n\r\n  function getConfig(): ModalConfig {\r\n    return { ...config }\r\n  }\r\n\r\n  function setConfig(newConfig: Partial<ModalConfig>): void {\r\n    Object.assign(config, newConfig)\r\n  }\r\n\r\n  function destroy(): void {\r\n    if (isOpen()) {\r\n      close()\r\n    }\r\n    teardownFocusTrap()\r\n    animationController.destroy()\r\n    contentElement = null\r\n    overlayElement = null\r\n    containerElement = null\r\n  }\r\n\r\n  // ============ INTERNAL INTERFACE ============\r\n\r\n  const modal: ModalInternal = {\r\n    // Public API\r\n    isOpen,\r\n    isMounted,\r\n    getState,\r\n    subscribe,\r\n    open,\r\n    close,\r\n    toggle,\r\n    getStackOrder,\r\n    isTopMost,\r\n    isAnimating,\r\n    getAnimationState,\r\n    focusFirst,\r\n    focusLast,\r\n    contains,\r\n    getPortalTarget,\r\n    getPortalProps,\r\n    getOverlayProps,\r\n    getContainerProps,\r\n    getContentProps,\r\n    getTitleProps,\r\n    getDescriptionProps,\r\n    getCloseButtonProps,\r\n    getTriggerProps,\r\n    getConfig,\r\n    setConfig,\r\n    destroy,\r\n\r\n    // Internal API\r\n    _id: baseId,\r\n    _getTitleId: () => ids.titleId,\r\n    _getDescriptionId: () => ids.descriptionId,\r\n    _setStackOrder: (order) => stateManager.setState({ stackOrder: order }),\r\n    _setIsTopMost: (isTop) => stateManager.setState({ isTopMost: isTop }),\r\n    _getContentElement: () => contentElement,\r\n    _handleOverlayClick: handleOverlayClick,\r\n    _handleKeyDown: handleKeyDown,\r\n  }\r\n\r\n  // Open if defaultOpen is true\r\n  if (initialOpen) {\r\n    stackInternal.push(modal)\r\n  }\r\n\r\n  return modal\r\n}\r\n","/**\r\n * Base utilities for dialog implementations\r\n */\r\n\r\nimport { createModal } from '../core/modal'\r\nimport type { ModalConfig } from '../types'\r\n\r\n/**\r\n * Dialog variant types\r\n */\r\nexport type DialogVariant =\r\n  | 'default'\r\n  | 'primary'\r\n  | 'danger'\r\n  | 'warning'\r\n  | 'success'\r\n  | 'error'\r\n  | 'info'\r\n\r\n/**\r\n * Create dialog container elements\r\n */\r\nexport function createDialogElements(modal: ReturnType<typeof createModal>): {\r\n  portal: HTMLDivElement\r\n  overlay: HTMLDivElement\r\n  container: HTMLDivElement\r\n  content: HTMLDivElement\r\n} {\r\n  const portal = document.createElement('div')\r\n  const portalProps = modal.getPortalProps()\r\n  portal.setAttribute('data-modalkit-portal', portalProps['data-modalkit-portal'])\r\n  portal.setAttribute('data-state', portalProps['data-state'])\r\n\r\n  const overlay = document.createElement('div')\r\n  const overlayProps = modal.getOverlayProps()\r\n  overlay.setAttribute('data-modalkit-overlay', '')\r\n  overlay.setAttribute('data-state', overlayProps['data-state'])\r\n  Object.assign(overlay.style, overlayProps.style)\r\n  overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.5)'\r\n  overlayProps.ref(overlay)\r\n\r\n  const container = document.createElement('div')\r\n  const containerProps = modal.getContainerProps()\r\n  container.setAttribute('data-modalkit-container', '')\r\n  container.setAttribute('data-state', containerProps['data-state'])\r\n  Object.assign(container.style, containerProps.style)\r\n  containerProps.ref(container)\r\n\r\n  const content = document.createElement('div')\r\n  const contentProps = modal.getContentProps()\r\n  content.setAttribute('role', contentProps.role)\r\n  content.setAttribute('aria-modal', 'true')\r\n  if (contentProps['aria-labelledby']) {\r\n    content.setAttribute('aria-labelledby', contentProps['aria-labelledby'])\r\n  }\r\n  if (contentProps['aria-describedby']) {\r\n    content.setAttribute('aria-describedby', contentProps['aria-describedby'])\r\n  }\r\n  content.setAttribute('data-modalkit-content', '')\r\n  content.setAttribute('data-state', contentProps['data-state'])\r\n  content.setAttribute('tabindex', '-1')\r\n  content.style.backgroundColor = 'white'\r\n  content.style.borderRadius = '8px'\r\n  content.style.padding = '24px'\r\n  content.style.maxWidth = '400px'\r\n  content.style.width = '100%'\r\n  content.style.boxShadow = '0 25px 50px -12px rgba(0, 0, 0, 0.25)'\r\n  contentProps.ref(content)\r\n\r\n  // Add keyboard handler\r\n  content.addEventListener('keydown', (e) => {\r\n    contentProps.onKeyDown(e)\r\n  })\r\n\r\n  // Assemble\r\n  container.appendChild(content)\r\n  overlay.appendChild(container)\r\n  portal.appendChild(overlay)\r\n\r\n  return { portal, overlay, container, content }\r\n}\r\n\r\n/**\r\n * Create a dialog modal with common configuration\r\n */\r\nexport function createDialogModal(\r\n  customConfig?: Partial<ModalConfig>\r\n): ReturnType<typeof createModal> {\r\n  return createModal({\r\n    closeOnOverlayClick: false,\r\n    closeOnEscape: true,\r\n    trapFocus: true,\r\n    preventScroll: true,\r\n    role: 'alertdialog',\r\n    animated: false,\r\n    ...customConfig,\r\n  })\r\n}\r\n\r\n/**\r\n * Apply styles for a button\r\n */\r\nexport function styleButton(\r\n  button: HTMLButtonElement,\r\n  variant: DialogVariant = 'default'\r\n): void {\r\n  button.style.padding = '8px 16px'\r\n  button.style.borderRadius = '6px'\r\n  button.style.border = 'none'\r\n  button.style.cursor = 'pointer'\r\n  button.style.fontWeight = '500'\r\n  button.style.fontSize = '14px'\r\n  button.style.transition = 'background-color 0.2s'\r\n\r\n  switch (variant) {\r\n    case 'primary':\r\n      button.style.backgroundColor = '#3b82f6'\r\n      button.style.color = 'white'\r\n      break\r\n    case 'danger':\r\n    case 'error':\r\n      button.style.backgroundColor = '#ef4444'\r\n      button.style.color = 'white'\r\n      break\r\n    case 'warning':\r\n      button.style.backgroundColor = '#f59e0b'\r\n      button.style.color = 'white'\r\n      break\r\n    case 'success':\r\n      button.style.backgroundColor = '#10b981'\r\n      button.style.color = 'white'\r\n      break\r\n    case 'info':\r\n      button.style.backgroundColor = '#3b82f6'\r\n      button.style.color = 'white'\r\n      break\r\n    default:\r\n      button.style.backgroundColor = '#e5e7eb'\r\n      button.style.color = '#374151'\r\n  }\r\n}\r\n\r\n/**\r\n * Create dialog title element\r\n */\r\nexport function createTitleElement(\r\n  title: string,\r\n  modal: ReturnType<typeof createModal>\r\n): HTMLHeadingElement {\r\n  const titleProps = modal.getTitleProps()\r\n  const titleEl = document.createElement('h2')\r\n  titleEl.id = titleProps.id\r\n  titleEl.setAttribute('data-modalkit-title', '')\r\n  titleEl.textContent = title\r\n  titleEl.style.margin = '0 0 8px 0'\r\n  titleEl.style.fontSize = '18px'\r\n  titleEl.style.fontWeight = '600'\r\n  titleEl.style.color = '#111827'\r\n  return titleEl\r\n}\r\n\r\n/**\r\n * Create dialog message element\r\n */\r\nexport function createMessageElement(\r\n  message: string,\r\n  modal: ReturnType<typeof createModal>\r\n): HTMLParagraphElement {\r\n  const descProps = modal.getDescriptionProps()\r\n  const messageEl = document.createElement('p')\r\n  messageEl.id = descProps.id\r\n  messageEl.setAttribute('data-modalkit-description', '')\r\n  messageEl.textContent = message\r\n  messageEl.style.margin = '0 0 24px 0'\r\n  messageEl.style.fontSize = '14px'\r\n  messageEl.style.color = '#6b7280'\r\n  messageEl.style.lineHeight = '1.5'\r\n  return messageEl\r\n}\r\n\r\n/**\r\n * Create button container\r\n */\r\nexport function createButtonContainer(): HTMLDivElement {\r\n  const container = document.createElement('div')\r\n  container.style.display = 'flex'\r\n  container.style.justifyContent = 'flex-end'\r\n  container.style.gap = '8px'\r\n  return container\r\n}\r\n","/**\r\n * Confirm dialog implementation\r\n */\r\n\r\nimport type { ConfirmOptions, ConfirmOptionsAdvanced, ConfirmButton } from '../types'\r\nimport {\r\n  createDialogModal,\r\n  createDialogElements,\r\n  createTitleElement,\r\n  createMessageElement,\r\n  createButtonContainer,\r\n  styleButton,\r\n} from './base'\r\n\r\n/**\r\n * Default confirm options\r\n */\r\nconst DEFAULT_OPTIONS: Required<Omit<ConfirmOptions, 'title'>> = {\r\n  message: '',\r\n  confirmText: 'Confirm',\r\n  cancelText: 'Cancel',\r\n  variant: 'default',\r\n  closeOnOverlayClick: false,\r\n  closeOnEscape: true,\r\n}\r\n\r\n/**\r\n * Show a confirm dialog\r\n */\r\nexport function confirm(message: string): Promise<boolean>\r\nexport function confirm(options: ConfirmOptions): Promise<boolean>\r\nexport function confirm(options: ConfirmOptionsAdvanced): Promise<string | boolean>\r\nexport function confirm(\r\n  messageOrOptions: string | ConfirmOptions | ConfirmOptionsAdvanced\r\n): Promise<boolean | string> {\r\n  return new Promise((resolve) => {\r\n    // Normalize options\r\n    const options: ConfirmOptionsAdvanced =\r\n      typeof messageOrOptions === 'string'\r\n        ? { message: messageOrOptions }\r\n        : messageOrOptions\r\n\r\n    const {\r\n      title,\r\n      message,\r\n      confirmText = DEFAULT_OPTIONS.confirmText,\r\n      cancelText = DEFAULT_OPTIONS.cancelText,\r\n      variant = DEFAULT_OPTIONS.variant,\r\n      closeOnOverlayClick = DEFAULT_OPTIONS.closeOnOverlayClick,\r\n      closeOnEscape = DEFAULT_OPTIONS.closeOnEscape,\r\n      buttons,\r\n    } = options\r\n\r\n    // Track if resolved\r\n    let resolved = false\r\n\r\n    // Create modal\r\n    const modal = createDialogModal({\r\n      closeOnOverlayClick,\r\n      closeOnEscape,\r\n      onClose: () => {\r\n        if (!resolved) {\r\n          resolved = true\r\n          resolve(false)\r\n        }\r\n        cleanup()\r\n      },\r\n    })\r\n\r\n    // Create elements\r\n    const { portal, content } = createDialogElements(modal)\r\n\r\n    // Add title if provided\r\n    if (title) {\r\n      content.appendChild(createTitleElement(title, modal))\r\n    }\r\n\r\n    // Add message\r\n    content.appendChild(createMessageElement(message, modal))\r\n\r\n    // Create button container\r\n    const buttonContainer = createButtonContainer()\r\n\r\n    // Determine buttons to show\r\n    const buttonsToRender: ConfirmButton[] = buttons ?? [\r\n      { text: cancelText, value: false, variant: 'default' },\r\n      { text: confirmText, value: true, variant: variant === 'default' ? 'primary' : variant, autoFocus: true },\r\n    ]\r\n\r\n    // Create buttons\r\n    let autoFocusButton: HTMLButtonElement | null = null\r\n\r\n    buttonsToRender.forEach((btnConfig) => {\r\n      const button = document.createElement('button')\r\n      button.textContent = btnConfig.text\r\n      button.type = 'button'\r\n      styleButton(button, btnConfig.variant)\r\n\r\n      button.addEventListener('click', () => {\r\n        if (resolved) return // Prevent double resolution\r\n        resolved = true\r\n        modal.close() // Will trigger cleanup via onClose\r\n        resolve(btnConfig.value)\r\n      })\r\n\r\n      if (btnConfig.autoFocus) {\r\n        autoFocusButton = button\r\n      }\r\n\r\n      buttonContainer.appendChild(button)\r\n    })\r\n\r\n    content.appendChild(buttonContainer)\r\n\r\n    // Cleanup function\r\n    function cleanup(): void {\r\n      modal.destroy()\r\n      portal.remove()\r\n    }\r\n\r\n    // Mount and open\r\n    document.body.appendChild(portal)\r\n    modal.open()\r\n\r\n    // Focus the auto-focus button\r\n    if (autoFocusButton) {\r\n      requestAnimationFrame(() => {\r\n        autoFocusButton?.focus()\r\n      })\r\n    }\r\n  })\r\n}\r\n","/**\r\n * Alert dialog implementation\r\n */\r\n\r\nimport type { AlertOptions } from '../types'\r\nimport {\r\n  createDialogModal,\r\n  createDialogElements,\r\n  createTitleElement,\r\n  createMessageElement,\r\n  createButtonContainer,\r\n  styleButton,\r\n  type DialogVariant,\r\n} from './base'\r\n\r\n/**\r\n * Default alert options\r\n */\r\nconst DEFAULT_OPTIONS: Required<Omit<AlertOptions, 'title'>> = {\r\n  message: '',\r\n  confirmText: 'OK',\r\n  variant: 'default',\r\n}\r\n\r\n/**\r\n * Map alert variants to button variants\r\n */\r\nfunction getButtonVariant(alertVariant: AlertOptions['variant']): DialogVariant {\r\n  switch (alertVariant) {\r\n    case 'success':\r\n      return 'success'\r\n    case 'warning':\r\n      return 'warning'\r\n    case 'error':\r\n      return 'danger'\r\n    case 'info':\r\n      return 'info'\r\n    default:\r\n      return 'primary'\r\n  }\r\n}\r\n\r\n/**\r\n * Show an alert dialog\r\n */\r\nexport function alert(message: string): Promise<void>\r\nexport function alert(options: AlertOptions): Promise<void>\r\nexport function alert(messageOrOptions: string | AlertOptions): Promise<void> {\r\n  return new Promise((resolve) => {\r\n    // Normalize options\r\n    const options: AlertOptions =\r\n      typeof messageOrOptions === 'string'\r\n        ? { message: messageOrOptions }\r\n        : messageOrOptions\r\n\r\n    const {\r\n      title,\r\n      message,\r\n      confirmText = DEFAULT_OPTIONS.confirmText,\r\n      variant = DEFAULT_OPTIONS.variant,\r\n    } = options\r\n\r\n    // Create modal\r\n    const modal = createDialogModal({\r\n      closeOnOverlayClick: false,\r\n      closeOnEscape: true,\r\n      onClose: () => {\r\n        resolve()\r\n        cleanup()\r\n      },\r\n    })\r\n\r\n    // Create elements\r\n    const { portal, content } = createDialogElements(modal)\r\n\r\n    // Add title if provided\r\n    if (title) {\r\n      content.appendChild(createTitleElement(title, modal))\r\n    }\r\n\r\n    // Add message\r\n    content.appendChild(createMessageElement(message, modal))\r\n\r\n    // Create button container\r\n    const buttonContainer = createButtonContainer()\r\n\r\n    // Create confirm button\r\n    const confirmButton = document.createElement('button')\r\n    confirmButton.textContent = confirmText\r\n    confirmButton.type = 'button'\r\n    styleButton(confirmButton, getButtonVariant(variant))\r\n\r\n    confirmButton.addEventListener('click', () => {\r\n      modal.close()\r\n    })\r\n\r\n    buttonContainer.appendChild(confirmButton)\r\n    content.appendChild(buttonContainer)\r\n\r\n    // Cleanup function\r\n    function cleanup(): void {\r\n      modal.destroy()\r\n      portal.remove()\r\n    }\r\n\r\n    // Mount and open\r\n    document.body.appendChild(portal)\r\n    modal.open()\r\n\r\n    // Focus the confirm button\r\n    requestAnimationFrame(() => {\r\n      confirmButton.focus()\r\n    })\r\n  })\r\n}\r\n","/**\r\n * Prompt dialog implementation\r\n */\r\n\r\nimport type { PromptOptions } from '../types'\r\nimport {\r\n  createDialogModal,\r\n  createDialogElements,\r\n  createTitleElement,\r\n  createMessageElement,\r\n  createButtonContainer,\r\n  styleButton,\r\n} from './base'\r\n\r\n/**\r\n * Default prompt options\r\n */\r\nconst DEFAULT_OPTIONS: Required<\r\n  Omit<PromptOptions, 'title' | 'message' | 'validate'>\r\n> = {\r\n  placeholder: '',\r\n  defaultValue: '',\r\n  confirmText: 'OK',\r\n  cancelText: 'Cancel',\r\n  type: 'text',\r\n  required: false,\r\n  minLength: 0,\r\n  maxLength: Infinity,\r\n}\r\n\r\n/**\r\n * Show a prompt dialog\r\n */\r\nexport function prompt(message: string): Promise<string | null>\r\nexport function prompt(options: PromptOptions): Promise<string | null>\r\nexport function prompt(\r\n  messageOrOptions: string | PromptOptions\r\n): Promise<string | null> {\r\n  return new Promise((resolve) => {\r\n    // Normalize options\r\n    const options: PromptOptions =\r\n      typeof messageOrOptions === 'string'\r\n        ? { message: messageOrOptions }\r\n        : messageOrOptions\r\n\r\n    const {\r\n      title,\r\n      message,\r\n      placeholder = DEFAULT_OPTIONS.placeholder,\r\n      defaultValue = DEFAULT_OPTIONS.defaultValue,\r\n      confirmText = DEFAULT_OPTIONS.confirmText,\r\n      cancelText = DEFAULT_OPTIONS.cancelText,\r\n      type = DEFAULT_OPTIONS.type,\r\n      validate,\r\n      required = DEFAULT_OPTIONS.required,\r\n      minLength = DEFAULT_OPTIONS.minLength,\r\n      maxLength = DEFAULT_OPTIONS.maxLength,\r\n    } = options\r\n\r\n    // Track if resolved\r\n    let resolved = false\r\n\r\n    // Create modal\r\n    const modal = createDialogModal({\r\n      closeOnOverlayClick: false,\r\n      closeOnEscape: true,\r\n      onClose: () => {\r\n        if (!resolved) {\r\n          resolved = true\r\n          resolve(null)\r\n        }\r\n        cleanup()\r\n      },\r\n    })\r\n\r\n    // Create elements\r\n    const { portal, content } = createDialogElements(modal)\r\n\r\n    // Add title if provided\r\n    if (title) {\r\n      content.appendChild(createTitleElement(title, modal))\r\n    }\r\n\r\n    // Add message if provided\r\n    if (message) {\r\n      content.appendChild(createMessageElement(message, modal))\r\n    }\r\n\r\n    // Create input container\r\n    const inputContainer = document.createElement('div')\r\n    inputContainer.style.marginBottom = '16px'\r\n\r\n    // Create input\r\n    const input = document.createElement('input')\r\n    input.type = type\r\n    input.value = defaultValue\r\n    if (placeholder) input.placeholder = placeholder\r\n    if (required) input.required = true\r\n    if (minLength > 0) input.minLength = minLength\r\n    if (maxLength < Infinity) input.maxLength = maxLength\r\n\r\n    input.style.width = '100%'\r\n    input.style.padding = '8px 12px'\r\n    input.style.border = '1px solid #d1d5db'\r\n    input.style.borderRadius = '6px'\r\n    input.style.fontSize = '14px'\r\n    input.style.outline = 'none'\r\n    input.style.boxSizing = 'border-box'\r\n\r\n    input.addEventListener('focus', () => {\r\n      input.style.borderColor = '#3b82f6'\r\n      input.style.boxShadow = '0 0 0 3px rgba(59, 130, 246, 0.1)'\r\n    })\r\n\r\n    input.addEventListener('blur', () => {\r\n      input.style.borderColor = '#d1d5db'\r\n      input.style.boxShadow = 'none'\r\n    })\r\n\r\n    // Create error message element\r\n    const errorEl = document.createElement('p')\r\n    errorEl.style.color = '#ef4444'\r\n    errorEl.style.fontSize = '12px'\r\n    errorEl.style.marginTop = '4px'\r\n    errorEl.style.marginBottom = '0'\r\n    errorEl.style.display = 'none'\r\n\r\n    inputContainer.appendChild(input)\r\n    inputContainer.appendChild(errorEl)\r\n    content.appendChild(inputContainer)\r\n\r\n    // Validation function\r\n    function validateInput(): boolean | string {\r\n      const value = input.value\r\n\r\n      // Required check\r\n      if (required && !value.trim()) {\r\n        return 'This field is required'\r\n      }\r\n\r\n      // Min length check\r\n      if (minLength > 0 && value.length < minLength) {\r\n        return `Minimum ${minLength} characters required`\r\n      }\r\n\r\n      // Max length check\r\n      if (maxLength < Infinity && value.length > maxLength) {\r\n        return `Maximum ${maxLength} characters allowed`\r\n      }\r\n\r\n      // Custom validation\r\n      if (validate) {\r\n        return validate(value)\r\n      }\r\n\r\n      return true\r\n    }\r\n\r\n    function showError(message: string): void {\r\n      errorEl.textContent = message\r\n      errorEl.style.display = 'block'\r\n      input.style.borderColor = '#ef4444'\r\n    }\r\n\r\n    function clearError(): void {\r\n      errorEl.style.display = 'none'\r\n      input.style.borderColor = '#d1d5db'\r\n    }\r\n\r\n    function handleSubmit(): void {\r\n      if (resolved) return // Prevent double resolution\r\n      clearError()\r\n      const validationResult = validateInput()\r\n\r\n      if (validationResult !== true) {\r\n        const errorMessage =\r\n          typeof validationResult === 'string'\r\n            ? validationResult\r\n            : 'Invalid input'\r\n        showError(errorMessage)\r\n        input.focus()\r\n        return\r\n      }\r\n\r\n      resolved = true\r\n      modal.close() // Will trigger cleanup via onClose\r\n      resolve(input.value)\r\n    }\r\n\r\n    // Handle Enter key\r\n    input.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Enter') {\r\n        e.preventDefault()\r\n        handleSubmit()\r\n      }\r\n    })\r\n\r\n    // Clear error on input\r\n    input.addEventListener('input', clearError)\r\n\r\n    // Create button container\r\n    const buttonContainer = createButtonContainer()\r\n\r\n    // Cancel button\r\n    const cancelButton = document.createElement('button')\r\n    cancelButton.textContent = cancelText\r\n    cancelButton.type = 'button'\r\n    styleButton(cancelButton, 'default')\r\n\r\n    cancelButton.addEventListener('click', () => {\r\n      if (resolved) return // Prevent double resolution\r\n      resolved = true\r\n      modal.close() // Will trigger cleanup via onClose\r\n      resolve(null)\r\n    })\r\n\r\n    // Confirm button\r\n    const confirmButton = document.createElement('button')\r\n    confirmButton.textContent = confirmText\r\n    confirmButton.type = 'button'\r\n    styleButton(confirmButton, 'primary')\r\n\r\n    confirmButton.addEventListener('click', handleSubmit)\r\n\r\n    buttonContainer.appendChild(cancelButton)\r\n    buttonContainer.appendChild(confirmButton)\r\n    content.appendChild(buttonContainer)\r\n\r\n    // Cleanup function\r\n    function cleanup(): void {\r\n      modal.destroy()\r\n      portal.remove()\r\n    }\r\n\r\n    // Mount and open\r\n    document.body.appendChild(portal)\r\n    modal.open()\r\n\r\n    // Focus the input\r\n    requestAnimationFrame(() => {\r\n      input.focus()\r\n      // Select default value\r\n      if (defaultValue) {\r\n        input.select()\r\n      }\r\n    })\r\n  })\r\n}\r\n"]}